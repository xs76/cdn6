window.__require=function t(e,o,i){function n(s,c){if(!o[s]){if(!e[s]){var r=s.split("/");if(r=r[r.length-1],!e[r]){var l="function"==typeof __require&&__require;if(!c&&l)return l(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+s+"'")}}var h=o[s]={exports:{}};e[s][0].call(h.exports,function(t){return n(e[s][1][t]||t)},h,h.exports,t,e,o,i)}return o[s].exports}for(var a="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({AICar:[function(t,e,o){"use strict";cc._RF.push(e,"f1600Vo38hJJYZP47yGzKX1","AICar");var i=t("Constants"),n=t("Constants").TRAFFIC_STATES;cc.Class({extends:cc.Component,properties:{speed:150,sparkPrefab:cc.Prefab},onLoad:function(){this.nearMissCounted=!1;for(var t=[n.HIT,n.THRASHED],e=0;e<t.length;e++){this.node.addComponent(t[e]).enabled=!1}},start:function(){},update:function(t){},unuse:function(){this.node.active=!1,this.curState=this.node.getComponent(n.MOVING),this.curState.enabled=!1;var t=this.node.getComponent(n.THRASHED);t&&(t.enabled=!1);var e=this.node.getComponent(n.HIT);e&&(e.enabled=!1)},reuse:function(){this.node.stopAllActions(),this.node.position=cc.v3(0,0,0),this.node.active=!0,this.speed=i.GAMEPLAY.TRAFFIC_DEFAULT_SPEED,this.nearMissCounted=!1,this.curState.enabled=!0},getCurrentState:function(){return this.curState},setState:function(t){this.curState.enabled=!1,this.curState=this.node.getComponent(t),this.curState.enabled=!0}}),cc._RF.pop()},{Constants:"Constants"}],CameraAnimations:[function(t,e,o){"use strict";cc._RF.push(e,"a3003UVJNBOQqjanZ/M4dUg","CameraAnimations");e.exports=[[[[0,5,9.5],[-20,0,0],.487],[[0,5,1.7],[-90,0,0],.487],[[0,3.5,4.3],[-60,0,0],.487],[[0,2.8,5.9],[-50,0,0],.487],[[0,4.5,9.5],[-35.8,0,0],.487],[[0,5,11],[-19,0,0],.487],[[0,5,9.5],[-20,0,0],.487]],[[[0,50,-500],[-20,0,0],.01],[[0,50,-483],[-20,0,0],1.2],[[0,50,-400],[-20,0,0],.01],[[0,50,-385],[-20,0,0],.37],[[0,50,-315],[-20,0,0],.01],[[0,50,-300],[-20,0,0],.37],[[0,50,-230],[-20,0,0],.01],[[0,50,-215],[-20,0,0],.37],[[0,50,-145],[-20,0,0],.01],[[0,50,-130],[-20,0,0],.37],[[0,50,-60],[-20,0,0],.01],[[0,50,-45],[-20,0,0],.37],[[0,52,95],[-22.5,0,0],.1],[[0,57,115.5],[-25,0,0],.15],[[0,50,115.5],[-20,0,0],.12],[[0,47,110.5],[-17.5,0,0],.12],[[0,45,100.5],[-15.5,0,0],.12],[[0,50,95],[-20,0,0],.1]],[[[0,50,-12],[-60,0,0],.01],[[0,25,135],[-60,0,0],5],[[0,50,95],[-18,0,0],1.5],[[0,50,95],[-20,0,0],.3]],[[[-3,.75,.25],[0,-138,0],.341],[[-2.54,.75,.25],[0,-144.38,0],.341],[[-1.99,.75,.25],[0,-152.11,0],.341],[[-1.37,.75,.25],[0,-160.85,0],.341],[[-.7,.75,.25],[0,-170.26,0],.341],[[0,.75,.25],[0,180,0],.341],[[.7,.75,.25],[0,170.26,0],.341],[[1.37,.75,.25],[0,160.85,0],.341],[[1.99,.75,.25],[0,152.11,0],.341],[[2.54,.75,.25],[0,144.38,0],.341],[[0,5,9.5],[-20,0,0],.01]],[[[1.89,1,5.94],[-356.82,42.37,0],.31],[[1.78,.99,6.25],[-356.44,36.83,0],.31],[[1.68,.97,6.56],[-355.83,31.18,0],.31],[[1.57,.96,6.87],[-355.7,25.77,0],.31],[[1.42,1,7.21],[-356.78,20.94,0],.31],[[1.22,1.25,7.57],[-359.31,16.8,0],.31],[[1,1.8,7.94],[-2.8,13.13,0],.31],[[.75,2.55,8.33],[-6.94,9.77,0],.31],[[.5,3.4,8.72],[-11.4,6.56,0],.31],[[.24,4.25,9.11],[-15.86,3.36,0],.31],[[0,5,9.5],[-20,0,0],.31]]],cc._RF.pop()},{}],CarCustomization:[function(t,e,o){"use strict";cc._RF.push(e,"d2973B2mQBLBLD1qDDXVJXM","CarCustomization");var i=t("MenuStateMachine"),n=(t("MenuState"),t("MenuConstants")),a=n.MS,s=n.ME,c=t("DefaultState"),r=t("CarPaintState"),l=t("RoofDecalState"),h=t("HoodDecalState"),u=t("../Inventory"),d=(t("../Constants"),PlatformLayer);cc.Class({extends:cc.Component,properties:{TintMaterial:{default:null,type:cc.Material},HoodDecalMaterial:{default:null,type:cc.Material},RoofDecalMaterial:{default:null,type:cc.Material},DecalListContainer:{type:cc.Node,default:null},DecalItemPrefab:{default:null,type:cc.Prefab},DecalSprites:{default:[],type:cc.SpriteFrame},ColorPicker:{default:null,type:cc.Node},DecalPicker:{default:null,type:cc.Node},CameraAnimation:{default:null,type:cc.Animation},ButtonSprites:{default:[],type:cc.Node},ActiveButtonColor:{default:cc.Color.WHITE,type:cc.Color},PlayButton:{default:null,type:cc.Node},MuteButton:{default:null,type:cc.Node},Overlay:{default:null,type:cc.Node},coins:{visible:!1,get:function(){return this._coins},set:function(t){this._coins=t,this.CoinDisplay.string=""+this._coins}},coinPrefab:{default:null,type:cc.Prefab},decalPreview:{default:null,type:cc.Sprite}},onLoad:function(){u.load(),this.CoinDisplay=this.node.getComponentInChildren(cc.Label),this.coins=u.getUserCoins(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this.onSizeChanged,this),this.onSizeChanged(),this.music=this.node.getComponents(cc.AudioSource),u.isAudioMuted()&&this.MuteButton.getComponent(cc.Toggle).check(),this.setAudioMute(),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.game.on(d.AD_SHOWN_RESPONSE,this.adRewards,this),this.animHandle=this.node.getComponent(cc.Animation),"homecount"in window?(window.homecount+=1,window.homecount%4==0&&this.showEarnCoinsDialog()):window.homecount=1},showBuyConfirmation:function(){this.Overlay.active=!0,cc.find("/Canvas/ConfirmBuy").active=!0,this.animHandle.play("home_confirm_show")},hideBuyConfirmation:function(){this.animHandle.play("home_confirm_hide")},showEarnCoinsDialog:function(){this.Overlay.active=!0;var t=cc.find("/Canvas/EarnCoinsScreen");t.getChildByName("WatchAd").active=!0,t.active=!0,this.animHandle.play("home_earn_reward")},watchAdClicked:function(){PlatformLayer.showAd("HomeScreen"),cc.find("/Canvas/EarnCoinsScreen").getChildByName("WatchAd").active=!1},cancelAdScreen:function(){this.animHandle.play("home_earn_hide")},adRewards:function(t){0===t.status?(u.addCoins(100),u.save(),this.showCoinChangeAnimation(100)):(cc.log("Reward ad Skipped"),this.cancelAdScreen())},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},onKeyDown:function(t){cc.macro.KEY.escape==t.keyCode&&this.stateMachine.onEvent(s.BACK_CLICKED)},setAudioMute:function(){if(u.isAudioMuted()){for(var t=0;t<this.music.length;t++)this.music[t].pause();cc.audioEngine.setEffectsVolume(0),cc.audioEngine.setMusicVolume(0)}else{for(t=0;t<this.music.length;t++)this.music[t].resume();cc.audioEngine.setEffectsVolume(1),cc.audioEngine.setMusicVolume(1)}},onSizeChanged:function(t){cc.log("Size Changed");var e=cc.find("/Canvas/UIContainer"),o=cc.find("/Canvas/EarnCoinsScreen"),i=cc.find("/Canvas/CoinDisplay"),n=cc.find("/Canvas/ConfirmBuy");this.node.width>this.node.height?(e.scale=.6,this.PlayButton.scale=.5,o.scale=.6,i.scale=.6,n.scale=.6):(e.scale=1,this.PlayButton.scale=1,o.scale=1.5,i.scale=1.5,n.scale=1.5)},getDecalSpriteByName:function(t){for(var e=0;e<this.DecalSprites.length;e++)if(0==this.DecalSprites[e].name.localeCompare(t))return this.DecalSprites[e];return null},showRandomStyle:function(){var t=cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())),e=this.DecalSprites[Math.floor(Math.random()*this.DecalSprites.length)];this.HoodDecalMaterial.setProperty("diffuseColor",t),this.HoodDecalMaterial.setProperty("diffuseTexture",e.getTexture()),t=cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())),e=this.DecalSprites[Math.floor(Math.random()*this.DecalSprites.length)],this.RoofDecalMaterial.setProperty("diffuseColor",t),this.RoofDecalMaterial.setProperty("diffuseTexture",e.getTexture()),t=cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())),this.TintMaterial.setProperty("diffuseColor",t)},showCoinChangeAnimation:function(t){var e=this,o=this.CoinDisplay.node.parent,i=cc.find("/Canvas/UIContainer");this.node.runAction(cc.repeat(cc.sequence(cc.callFunc(function(){t>0?e.animateCoinMovement([cc.Vec2.ZERO,o.position]):e.animateCoinMovement([o.position,i.position])}),cc.delayTime(.25*Math.random())),10));var n=o.scale;o.runAction(cc.sequence(cc.delayTime(t>0?1:.2),cc.repeat(cc.sequence([cc.scaleTo(.125,n+.2),cc.scaleTo(.125,n),cc.callFunc(function(){e._coins+=t/5,e.CoinDisplay.string=""+e._coins,cc.log(e._coins)})]),5),cc.callFunc(function(){cc.find("/Canvas/EarnCoinsScreen").active&&e.cancelAdScreen()})))},animateCoinMovement:function(t){var e=t[0],o=t[1],i=cc.instantiate(this.coinPrefab);this.node.width>this.node.height?i.scale=.25:i.scale=.5,i.position=e,this.node.addChild(i);var n=[-150,-250,-100,100,250,150],a=[cc.v2(e.x,e.y),cc.v2(e.x+n[Math.floor(Math.random()*n.length)],(e.y+o.y)/2),cc.v2(o.x,o.y)];i.runAction(cc.sequence(cc.bezierTo(1,a),cc.callFunc(function(){i.removeFromParent()})))},onIntroAnimationFinished:function(){this.PlayButton.active=!0,cc.find("/Canvas/UIContainer/StyleButtons").active=!0,this.CoinDisplay.node.parent.active=!0,this.unschedule(this.showRandomStyle,this);var t=u.getStyleInfo("hood");this.HoodDecalMaterial.setProperty("diffuseColor",cc.color(t.color[0],t.color[1],t.color[2]));var e=this.getDecalSpriteByName(t.decal);e&&this.HoodDecalMaterial.setProperty("diffuseTexture",e.getTexture());var o=u.getStyleInfo("roof");this.RoofDecalMaterial.setProperty("diffuseColor",cc.color(o.color[0],o.color[1],o.color[2])),(e=this.getDecalSpriteByName(o.decal))&&this.RoofDecalMaterial.setProperty("diffuseTexture",e.getTexture());var i=u.getStyleInfo("body");this.TintMaterial.setProperty("diffuseColor",cc.color(i.color[0],i.color[1],i.color[2]))},start:function(){for(var t=0;t<this.DecalSprites.length;t++){var e=cc.instantiate(this.DecalItemPrefab);e.children[0].getComponent(cc.Sprite).spriteFrame=this.DecalSprites[t],this.DecalListContainer.addChild(e),e.name=this.DecalSprites[t].name,e.on(cc.Node.EventType.TOUCH_END,this.onDecalItemClicked,this)}if(this.stateMachine=new i(this),this.stateMachine.states[a.DEFAULT]=new c(this.stateMachine),this.stateMachine.states[a.CAR_PAINT]=new r(this.stateMachine),this.stateMachine.states[a.ROOF_DECAL_PAINT]=new l(this.stateMachine),this.stateMachine.states[a.HOOD_DECAL_PAINT]=new h(this.stateMachine),this.stateMachine.changeState(a.DEFAULT),cc.audioEngine.stopAll(),1==window.garageIntroPlayed)this.onIntroAnimationFinished();else{window.garageIntroPlayed=!0;var o=this.CameraAnimation.play("camera_garage_intro");this.PlayButton.active=!1,this.CoinDisplay.node.parent.active=!1,cc.find("/Canvas/UIContainer/StyleButtons").active=!1,this.scheduleOnce(this.onIntroAnimationFinished,o.duration),this.schedule(this.showRandomStyle,.125),u.isAudioMuted()||this.music[0].play()}},onDecalItemClicked:function(t){for(var e=0,o=0;o<this.DecalSprites.length;o++)if(this.DecalSprites[o].name==t.target.name){e=o;break}this.stateMachine.onEvent(s.DECAL_SELECTED,e)},onMenuButtonClicked:function(t,e){switch(e){case"hood":this.stateMachine.onEvent(s.HOOD_CLICKED);break;case"roof":this.stateMachine.onEvent(s.ROOF_CLICKED);break;case"paint":this.stateMachine.onEvent(s.PAINT_CLICKED);break;case"play":this.stateMachine.onEvent(s.PLAY_CLICKED);break;case"buy":this.stateMachine.onEvent(s.BUY_CLICKED);break;case"cancel":this.stateMachine.onEvent(s.CANCEL_CLICKED);break;case"exit":this.stateMachine.onEvent(s.BACK_CLICKED);break;case"donate":cc.sys.openURL("https://vkrishna.itch.io/ttracing/donate");break;case"mute":var o=this.MuteButton.getComponent(cc.Toggle).isChecked;u.setAudioMuted(o),this.setAudioMute(),u.save()}},onColorChanged:function(t,e){var o=t.progress;this.stateMachine.onEvent(s.SLIDER_MOVED,cc.color().fromHSV(o,1,1))},onWhiteClicked:function(){this.stateMachine.onEvent(s.WHITE_CLICKED,cc.color().fromHSV(1,0,1))},onBlackClicked:function(){this.stateMachine.onEvent(s.BLACK_CLICKED,cc.color().fromHSV(0,0,.27))},update:function(t){this.stateMachine.update(t)}}),cc._RF.pop()},{"../Constants":"Constants","../Inventory":"Inventory",CarPaintState:"CarPaintState",DefaultState:"DefaultState",HoodDecalState:"HoodDecalState",MenuConstants:"MenuConstants",MenuState:"MenuState",MenuStateMachine:"MenuStateMachine",RoofDecalState:"RoofDecalState"}],CarPaintState:[function(t,e,o){"use strict";cc._RF.push(e,"4915chtjD1AZZgztT2MAw0K","CarPaintState"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var c=t("MenuState"),r=t("MenuConstants"),l=r.MS,h=r.ME,u=t("../Inventory"),d=function(t){function e(){return n(this,e),a(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,c),i(e,[{key:"initState",value:function(t,e){var o="",i=this.sm.owner.CameraAnimation;t==l.HOOD_DECAL_PAINT?o="camera_hood":t==l.ROOF_DECAL_PAINT&&(o="camera_roof"),""!=o&&(i.play(o,.25).wrapMode=cc.WrapMode.Reverse)}},{key:"onEnter",value:function(){this.colorWidget=this.sm.owner.ColorPicker,this.colorWidget.active=!0,this.TintMaterial=this.sm.owner.TintMaterial,this.sm.owner.ButtonSprites[2].color=this.sm.owner.ActiveButtonColor,this.exitButton=this.colorWidget.parent.parent.getChildByName("ExitCustomization"),this.exitButton.active=!0}},{key:"onEvent",value:function(t,e){switch(t){case h.SLIDER_MOVED:case h.BLACK_CLICKED:case h.WHITE_CLICKED:this.TintMaterial.setProperty("diffuseColor",e);break;case h.PAINT_CLICKED:case h.BACK_CLICKED:this.sm.changeState(l.DEFAULT);break;case h.HOOD_CLICKED:this.sm.changeState(l.HOOD_DECAL_PAINT);break;case h.ROOF_CLICKED:this.sm.changeState(l.ROOF_DECAL_PAINT)}}},{key:"onExit",value:function(){this.exitButton.active=!1,this.colorWidget.active=!1,this.sm.owner.ButtonSprites[2].color=cc.Color.WHITE;var t=this.TintMaterial.getProperty("diffuseColor");u.setStyleInfo("body",{color:[t.r,t.g,t.b]}),u.save()}}]),e}();o.default=d,e.exports=o.default,cc._RF.pop()},{"../Inventory":"Inventory",MenuConstants:"MenuConstants",MenuState:"MenuState"}],Coin:[function(t,e,o){"use strict";cc._RF.push(e,"edfcdx/0yZGKbBeym5/Sd0p","Coin");var i=t("Constants");cc.Class({extends:cc.Component,properties:{},start:function(){var t=cc.rotate3DBy(1.5,0,360,0),e=cc.repeatForever(t);"Coin"==this.node.name&&this.node.runAction(e)},unuse:function(){cc.log("Coin unuse"),this.getComponent(i.TRAFFIC_STATES.MOVING).enabled=!1,this.node.active=!1},reuse:function(){cc.log("Coin reuse"),this.getComponent(i.TRAFFIC_STATES.MOVING).enabled=!0,this.node.active=!0}}),cc._RF.pop()},{Constants:"Constants"}],CollisionUtils:[function(t,e,o){"use strict";cc._RF.push(e,"a27f2prkdNGsYI8p6zy3HuG","CollisionUtils"),Object.defineProperty(o,"__esModule",{value:!0});var i={isOverlapping:function(t,e){return!(Math.abs(t.center.x-e.center.x)>t.halfExtents.x+e.halfExtents.x||Math.abs(t.center.y-e.center.y)>t.halfExtents.y+e.halfExtents.y||Math.abs(t.center.z-e.center.z)>t.halfExtents.z+e.halfExtents.z)},createAABB:function(t){var e=t.getWorldPosition(cc.v3()),o=t.getWorldScale(cc.v3());return cc.geomUtils.Aabb.create(e.x,e.y,e.z,.5*o.x,.5*o.y,.5*o.z)},isPointInAABB:function(t,e){return!(Math.abs(t.x-e.center.x)>e.halfExtents.x||Math.abs(t.z-e.center.z)>e.halfExtents.z)}};o.default=i,e.exports=o.default,cc._RF.pop()},{}],Constants:[function(t,e,o){"use strict";cc._RF.push(e,"935610Kdq9P3ofRG8jsBrMj","Constants");var i={TRAFFIC_STATES:{HIT:"TrafficHit",MOVING:"TrafficMoving",THRASHED:"TrafficThrashed"},AI_COMPONENT:"AICar",PLAYER_COMPONENT:"PlayerMovement",ENV_COMPONENT:"SceneMovement",COIN_COMPONENT:"Coin",PLAYER_NODE:"PlayerCar",GAMEPLAY:{SCORE_COMPONENTS:{CHECKPOINT_REACHED:1e3,COIN_PICKED:20,CAR_SMASHED:50,NEAR_MISS:25},COINS_PER_CHUNK:10,COINS_PER_SET:5,TIMEBOUNS_ON_REVIVE:9,MAX_REVIVES_ALLOWED:1,AD_AUTO_TIMER:-1,AD_AUTO_EXIT:-1,PICKUPS_SPEED:150,PICKUPS_SPEED_ON_TIMEUP:0,CHUNKS_PER_1000M:13,PLAYER_TOP_SPEED:460,DISTANCE_PER_CHUNK:800,TRAFFIC_DEFAULT_SPEED:150,HANDLING:100,BOOST_BUMP:[20,40,60,80,100],BOOST_COOLDOWN:1.5,LANES:[-40,-20,0,20,40],TURBO_DURATION:6,CHUNK_COUNT_FIRST_TIME_TURBO:4,CHUNK_COUNT_AFTER_TURBO:11,UPGRADES:[{name:"Top Speed",costs:[0,1500,3e3,5e3],values:[440,450,460,470]},{name:"Acceleration",costs:[0,1500,3e3,5e3],values:[100,105,110,115]},{name:"Nitro",costs:[0,1500,3e3,5e3],values:[800,815,830,845]},{name:"Handling",costs:[0,1500,3e3,5e3],values:[105,110,115,120]}],STYLES_COSTS:{HOOD_DECAL_COST:100,ROOF_DECAL_COST:100,PAINT_COST:10}},GAME_STATES:{LOADING:1,ANIMATING:2,STARTED:3,PAUSED:4,OVER:5,WAITING_REVIVE:6},GAME_CONTROLLER_NODE:"GameController",RENDERING:{ZMIN:100,ZMAX:-1600,CAR_Z_POS:90,NORMAL_CAM_FOV:75.5,TURBO_CAM_FOV:120,TURBO_CAM_Z_POS:110,TURBO_POOL_SIZE:1,TRAFFIC_POOL_SIZE:32,COIN_POOL_SIZE:30,CHUNKS_PER_TUNNEL:30},GAME_EVENTS:{CHECKPOINT_REACHED:"cr",TURBO_PICKED:"tp",TURBO_ACTIVATED:"ta",TURBO_DEACTIVATED:"td",COIN_PICKED:"cp",CAR_DISPLACED:"cd",CAR_THRASHED:"ct",CAR_HIT:"ch",INTRO_ANIMATION_FINISHED:"ia",TIME_UP:"tu",PLAYER_REVIVED:"pr",GAME_OVER:"GameOver",AIRACER_TURBO_COLLIDED:"airtc",AIRACER_COIN_COLLIDED:"aircc",AIRACER_PLAYER_COLLIDED:"airpc",AIRACER_TRAFFIC_COLLIDED:"artc",AIRACER_THRASHED:"art",AIRACER_OVERTAKEN:"arot"},RACER_STATES:{DEFAULT:1,THRASHED:2,WAITING:3,TURBO:4}};e.exports=i,cc._RF.pop()},{}],DefaultState:[function(t,e,o){"use strict";cc._RF.push(e,"7e0edvQob9E5JU1PBz9uX/I","DefaultState"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(t("./MenuConstants"));function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var r=t("MenuState"),l=n.default.MS,h=n.default.ME,u=t("../Inventory"),d=function(t){function e(t){return a(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return c(e,r),i(e,[{key:"initState",value:function(t,e){this.anim2Play="",t==l.HOOD_DECAL_PAINT?this.anim2Play="camera_hood":t==l.ROOF_DECAL_PAINT&&(this.anim2Play="camera_roof")}},{key:"onEnter",value:function(){var t=this.sm.owner.CameraAnimation;""!=this.anim2Play&&(t.play(this.anim2Play,.25).wrapMode=cc.WrapMode.Reverse),this.sm.owner.PlayButton.active=!0}},{key:"onEvent",value:function(t,e){switch(t){case h.PAINT_CLICKED:this.sm.changeState(l.CAR_PAINT);break;case h.ROOF_CLICKED:this.sm.changeState(l.ROOF_DECAL_PAINT);break;case h.HOOD_CLICKED:this.sm.changeState(l.HOOD_DECAL_PAINT);break;case h.PLAY_CLICKED:var o=this.sm.owner.Overlay;o.active=!0,o.opacity=0,cc.tween(o).to(.25,{opacity:255}).start(),cc.director.preloadScene("gameplay",function(){cc.director.loadScene("gameplay"),void 0!==window.PlatformLayer&&window.PlatformLayer.showInterstitialAd()})}}},{key:"onUpdate",value:function(t){0==this.owner.music[0].isPlaying&&0==this.owner.music[1].isPlaying&&0==u.isAudioMuted()&&this.owner.music[1].play()}},{key:"onExit",value:function(){this.sm.owner.PlayButton.active=!1}}]),e}();o.default=d,e.exports=o.default,cc._RF.pop()},{"../Inventory":"Inventory","./MenuConstants":"MenuConstants",MenuState:"MenuState"}],EnvMap:[function(t,e,o){"use strict";cc._RF.push(e,"fe5cez7/n1L5IoRZ5duW7AZ","EnvMap"),cc.Class({extends:cc.Component,properties:{images:{default:[],type:cc.Texture2D},refMat:{default:null,type:cc.Material}},start:function(){for(var t=[],e=0;e<6;e++)t.push(this.images[e]._image);var o={width:512,height:512,images:[t]},i=new cc.gfx.TextureCube(cc.renderer.device,o);this.refMat.setProperty("skyBox",i)}}),cc._RF.pop()},{}],GameObject:[function(t,e,o){"use strict";cc._RF.push(e,"003cfs5JldEZaOxA0kX3YqT","GameObject"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},start:function(){}}),cc._RF.pop()},{}],HoodDecalState:[function(t,e,o){"use strict";cc._RF.push(e,"6e921jnqjRLrre9OPiKD+Gk","HoodDecalState"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),n=c(t("../Constants")),a=c(t("../Inventory")),s=c(t("./MenuConstants"));function c(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=t("MenuState"),d=s.default.MS,f=s.default.ME,p=function(t){function e(){return r(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return h(e,u),i(e,[{key:"initState",value:function(t,e){var o="camera_hood",i=cc.WrapMode.Normal,n=0;t==d.ROOF_DECAL_PAINT&&(o="camera_hood2roof",i=cc.WrapMode.Reverse,n=.25),this.sm.owner.CameraAnimation.play(o,n).wrapMode=i}},{key:"onEnter",value:function(){this.TintMaterial=this.sm.owner.HoodDecalMaterial,this.cp=this.sm.owner.ColorPicker,this.dp=this.sm.owner.DecalPicker,this.cp.active=!0,this.dp.active=!0,this.sm.owner.ButtonSprites[0].color=this.sm.owner.ActiveButtonColor,this.hoodStyle=Object.assign({},a.default.getStyleInfo("hood")),this.exitButton=this.cp.parent.parent.getChildByName("ExitCustomization"),this.exitButton.active=!0;for(var t=this.owner.DecalListContainer.children,e=0;e<t.length;e++)t[e].children[2].getComponent(cc.Label).string=""+n.default.GAMEPLAY.STYLES_COSTS.HOOD_DECAL_COST,a.default.getUserCoins()<n.default.GAMEPLAY.STYLES_COSTS.HOOD_DECAL_COST&&(t[e].children[2].color=cc.color(249,49,49))}},{key:"confirmBeforeExit",value:function(t){if(this.exitState=t,this.canBuyDecal()){var e=this.owner.getDecalSpriteByName(this.hoodStyle.decal);this.owner.decalPreview.spriteFrame=e,this.owner.showBuyConfirmation()}else this.resetDecal(),this.sm.changeState(t)}},{key:"onEvent",value:function(t,e){switch(t){case f.SLIDER_MOVED:case f.BLACK_CLICKED:case f.WHITE_CLICKED:this.TintMaterial.setProperty("diffuseColor",e),this.hoodStyle.color=[e.r,e.g,e.b];break;case f.PAINT_CLICKED:this.dp.active=!1,this.confirmBeforeExit(d.CAR_PAINT);break;case f.HOOD_CLICKED:case f.BACK_CLICKED:this.dp.active=!1,this.cp.active=!1,this.confirmBeforeExit(d.DEFAULT);break;case f.ROOF_CLICKED:this.confirmBeforeExit(d.ROOF_DECAL_PAINT);break;case f.DECAL_SELECTED:this.TintMaterial.setProperty("diffuseTexture",this.sm.owner.DecalSprites[e].getTexture()),this.hoodStyle.decal=this.sm.owner.DecalSprites[e].name;break;case f.BUY_CLICKED:a.default.addCoins(-n.default.GAMEPLAY.STYLES_COSTS.HOOD_DECAL_COST),this.owner.showCoinChangeAnimation(-n.default.GAMEPLAY.STYLES_COSTS.HOOD_DECAL_COST),this.owner.hideBuyConfirmation(),this.sm.changeState(this.exitState);break;case f.CANCEL_CLICKED:this.resetDecal(),this.owner.hideBuyConfirmation(),this.sm.changeState(this.exitState)}}},{key:"canBuyDecal",value:function(){var t=a.default.getUserCoins();return 0!=a.default.getStyleInfo("hood").decal.localeCompare(this.hoodStyle.decal)&&t>=n.default.GAMEPLAY.STYLES_COSTS.HOOD_DECAL_COST}},{key:"resetDecal",value:function(){var t=a.default.getStyleInfo("hood");this.hoodStyle.decal=t.decal;var e=this.owner.getDecalSpriteByName(this.hoodStyle.decal);this.TintMaterial.setProperty("diffuseTexture",e.getTexture())}},{key:"onExit",value:function(){this.exitButton.active=!1,this.sm.owner.ButtonSprites[0].color=cc.Color.WHITE,a.default.setStyleInfo("hood",this.hoodStyle),a.default.save()}}]),e}();o.default=p,e.exports=o.default,cc._RF.pop()},{"../Constants":"Constants","../Inventory":"Inventory","./MenuConstants":"MenuConstants",MenuState:"MenuState"}],InputHandler:[function(t,e,o){"use strict";cc._RF.push(e,"52794rXUkBIprM+T2M2ZF7F","InputHandler");var i=t("Constants");cc.Class({extends:cc.Component,properties:{leftArrow:{type:cc.Label,default:null},rightArrow:{type:cc.Label,default:null}},onLoad:function(){this.pm=cc.find(i.PLAYER_NODE).getComponent(i.PLAYER_COMPONENT),this.sm=cc.find(i.GAME_CONTROLLER_NODE).getComponent(i.ENV_COMPONENT)},onTouchStart:function(t){if(this.sm._gameState==i.GAME_STATES.STARTED){var e=.5*cc.winSize.width;t.getLocationX()<e?this.pm.startLaneChange(-1):this.pm.startLaneChange(1)}},onTouchEnd:function(t){this.pm.stopLaneChange()},onKeyDown:function(t){if(t.keyCode!=cc.macro.KEY.escape){if(this.sm._gameState==i.GAME_STATES.STARTED)switch(t.keyCode){case cc.macro.KEY.left:case cc.macro.KEY.a:this.pm.startLaneChange(-1);break;case cc.macro.KEY.right:case cc.macro.KEY.d:this.pm.startLaneChange(1)}}else this.sm._gameState!=i.GAME_STATES.STARTED&&this.sm._gameState!=i.GAME_STATES.PAUSED||this.sm.togglePause()},onKeyUp:function(t){t.keyCode!=cc.macro.KEY.left&&t.keyCode!=cc.macro.KEY.right&&t.keyCode!=cc.macro.KEY.d&&t.keyCode!=cc.macro.KEY.a||this.pm.stopLaneChange()},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),cc.sys.isMobile?(this.leftArrow.string="Tap",this.rightArrow.string="Tap"):(this.leftArrow.string="Left",this.rightArrow.string="Right")},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)}}),cc._RF.pop()},{Constants:"Constants"}],Inventory:[function(t,e,o){"use strict";cc._RF.push(e,"3ce6bz3rIhBGZkGjScvc095","Inventory"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("Constants"),n=(i.GAMEPLAY,{load:function(){window.userData={mute:!1,coins:100,upgrades:[3,3,3,3],car:0,style:{roof:{decal:"clash",color:[0,0,0]},hood:{decal:"skull",color:[0,0,0]},body:{color:[255,255,255]}}};try{window.localStorage&&window.localStorage["userData_v2.2"]&&(window.userData=JSON.parse(window.localStorage.getItem("userData_v2.2")),"mute"in window.userData==0&&(window.userData.mute=!1))}catch(t){cc.log(t)}},save:function(){if(window.userData)try{window.localStorage.setItem("userData_v2.2",JSON.stringify(window.userData))}catch(t){cc.log(t)}else cc.log("Could not find user data to save.")},upgrade:function(t){cc.log("To be implemented"),window.userData.upgrades[t]+=1},addCoins:function(t){Number.isInteger(t)?window.userData.coins+=t:cc.log("Please provide integer values for adding.")},getUserTopSpeed:function(){var t=i.GAMEPLAY.UPGRADES[0],e=window.userData.upgrades[0];return t.values[e]},getUserAcceleration:function(){var t=i.GAMEPLAY.UPGRADES[1],e=window.userData.upgrades[1];return t.values[e]},getUserNitroSpeed:function(){var t=i.GAMEPLAY.UPGRADES[2],e=window.userData.upgrades[2];return t.values[e]},getUserHandlingSpeed:function(){var t=i.GAMEPLAY.UPGRADES[3],e=window.userData.upgrades[3];return t.values[e]},getUserCoins:function(){return window.userData.coins},getStyleInfo:function(t){return window.userData.style[t]},setStyleInfo:function(t,e){window.userData.style[t]=e},isAudioMuted:function(){return window.userData.mute},setAudioMuted:function(t){window.userData.mute=t}});o.default=n,e.exports=o.default,cc._RF.pop()},{Constants:"Constants"}],LayoutHandler:[function(t,e,o){"use strict";cc._RF.push(e,"58155jFE7hDEql0sSkm4nlF","LayoutHandler"),cc.Class({extends:cc.Component,properties:{playButtons:{default:[],type:cc.Node}},onLoad:function(){this.node.on(cc.Node.EventType.SIZE_CHANGED,this.onSizeChanged,this)},onSizeChanged:function(){this.node.width>this.node.height?(cc.log("Landscape"),this.playButtons.forEach(function(t){t.scale=.5})):(cc.log("Portrait"),this.playButtons.forEach(function(t){t.scale=1}))},start:function(){this.onSizeChanged()}}),cc._RF.pop()},{}],MenuConstants:[function(t,e,o){"use strict";cc._RF.push(e,"7f4f9NoIGtFJ42ueriZBabp","MenuConstants"),Object.defineProperty(o,"__esModule",{value:!0});o.default={ME:{SLIDER_MOVED:1,BLACK_CLICKED:2,WHITE_CLICKED:3,PLAY_CLICKED:4,HOOD_CLICKED:5,ROOF_CLICKED:6,DECAL_SELECTED:7,PAINT_CLICKED:8,BACK_CLICKED:9,BUY_CLICKED:10,CANCEL_CLICKED:11},MS:{DEFAULT:"df",CAR_PAINT:"cp",HOOD_DECAL_PAINT:"hdp",ROOF_DECAL_PAINT:"rdp"}},e.exports=o.default,cc._RF.pop()},{}],MenuHandler:[function(t,e,o){"use strict";cc._RF.push(e,"f5ec2QxaOBNgby79H0jmwy8","MenuHandler");var i=t("Inventory"),n=t("Constants");cc.Class({extends:cc.Component,properties:{overLay:{default:null,type:cc.Sprite},coinCountLabel:{default:null,type:cc.Label},nextUpgradeBars:{default:[],type:cc.Sprite},curUpgradeBars:{default:[],type:cc.Sprite},upgradePriceLabels:{default:[],type:cc.Label}},onLoad:function(){i.load(),this.coinCountLabel.string=""+i.getUserCoins()},start:function(){this.updateBars()},updateBars:function(){for(var t=window.userData.upgrades,e=0;e<this.nextUpgradeBars.length;e++){this.nextUpgradeBars[e].node.width=900*Math.min(t[e]+2,4),this.curUpgradeBars[e].node.width=900*(t[e]+1);var o=n.GAMEPLAY.UPGRADES[e];t[e]<o.values.length-1?this.upgradePriceLabels[e].string=""+o.costs[t[e]+1]:this.upgradePriceLabels[e].string="MAX"}},onUpgradeClicked:function(t,e){window.userData.upgrades[e]+=1;var o=n.GAMEPLAY.UPGRADES[e];window.userData.upgrades[e]>o.values.length-1&&(window.userData.upgrades[e]=o.values.length-1),i.save(),this.updateBars()},onPlayClicked:function(){this.overLay.node.active=!0,this.overLay.node.runAction(cc.fadeIn(.125)),cc.director.preloadScene("gameplay",function(){cc.director.loadScene("gameplay"),void 0!==window.PlatformLayer&&window.PlatformLayer.showInterstitialAd()})},onUpgradesClicked:function(){var t=cc.find("/Canvas/ButtonGroup").getComponent(cc.Animation);t.play("hideButtonGroup"),(t=cc.find("/Canvas/UpgradeScreen").getComponent(cc.Animation)).play("showUpgradeScreen")},onUpgradesCloseClicked:function(){var t=cc.find("/Canvas/UpgradeScreen").getComponent(cc.Animation);t.play("hideUpgradeScreen"),(t=cc.find("/Canvas/ButtonGroup").getComponent(cc.Animation)).play("mainmenu")}}),cc._RF.pop()},{Constants:"Constants",Inventory:"Inventory"}],MenuStateMachine:[function(t,e,o){"use strict";cc._RF.push(e,"b760fuUoixNmbFAtFVq6+i/","MenuStateMachine"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(e){n(this,t),this.states={},this.curState=null,this.curStateName="",this.owner=null,this.owner=e}return i(t,[{key:"changeState",value:function(t,e){if(this.curState&&this.curState.onExit(),t in this.states){this.curState=this.states[t];var o=this.curStateName;this.curStateName=t,this.curState.initState(o,e),this.curState.onEnter()}}},{key:"onEvent",value:function(t,e){this.curState&&this.curState.onEvent(t,e)}},{key:"update",value:function(t){this.curState&&this.curState.onUpdate(t)}}]),t}();o.default=a,e.exports=o.default,cc._RF.pop()},{}],MenuState:[function(t,e,o){"use strict";cc._RF.push(e,"e48b0egSu9KBqny3xsEt3YZ","MenuState"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(e){n(this,t),this.sm=null,this.owner=null,this.sm=e,this.owner=e.owner}return i(t,[{key:"initState",value:function(t,e){}},{key:"onEnter",value:function(){}},{key:"onEvent",value:function(t,e){}},{key:"onUpdate",value:function(t){}},{key:"onExit",value:function(){}}]),t}();o.default=a,e.exports=o.default,cc._RF.pop()},{}],MyMoveTo:[function(t,e,o){"use strict";cc._RF.push(e,"b08925er9RH95mF6GiakIk2","MyMoveTo"),cc.Class({name:"MyMoveTo",extends:cc.ActionInterval,ctor:function(){var t=arguments[0],e=arguments[1],o=arguments[2],i=arguments[3];this._startPos=cc.v3(),this._dstPos=cc.v3(),this.initWithDuration(t,e,o,i)},initWithDuration:function(t,e,o,i){var n=cc.ActionInterval.prototype.initWithDuration.call(this,t);return this._dstPos.x=e,this._dstPos.y=o,this._dstPos.z=i,n},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startPos.x=this.target.position.x,this._startPos.y=this.target.position.y,this._startPos.z=this.target.position.z},update:function(t){var e=this._computeEaseTime(t);this.target&&(this.target.position=this._startPos.lerp(this._dstPos,e))}}),cc._RF.pop()},{}],PlatformLayer:[function(t,e,o){"use strict";cc._RF.push(e,"4705ar0LfdIDqmxpQcIlOsq","PlatformLayer"),function(){var t=window.PlatformLayer={isInitialized:!1,GameID:"655418749",DEVICE_EVENT:"DeviceEvent",VOLUME_SET:"SetVolume",AD_FETCH_RESPONSE:"AD_FETCH_RESPONSE",AD_SHOWN_RESPONSE:"AD_SHOWN_RESPONSE",INTERSTITIAL_FETCH_RESPONSE:"INTERSTITIAL_FETCH_RESPONSE",INTERSTITIAL_SHOWN_RESPONSE:"INTERSTITIAL_SHOWN_RESPONSE",onGameInit:function(e){console.log("OnGameInit:",JSON.stringify(e)),t.isInitialized=!0},onAudio:function(e){0==e.enable?cc.game.emit(t.VOLUME_SET,0):cc.game.emit(t.VOLUME_SET,e.volume/100)},initGame:function(){this.onGameInit("{}"),window.highScore=0;try{window.localStorage&&window.localStorage.highScore&&(window.highScore=parseInt(window.localStorage.highScore))}catch(t){cc.log(t)}},onPause:function(){console.log("+Platform::onPause"),cc.game.emit(t.DEVICE_EVENT,"pause"),console.log("-Platform::onPause")},onResume:function(){console.log("+Platform::onResume"),cc.game.emit(t.DEVICE_EVENT,"resume"),console.log("-Platform::onResume")},preFetchBannerAd:function(){if(this.isInitialized){window.bannerAd&&(window.bannerAd.hide(),window.bannerAd.destroy(),window.bannerAd=null);var t=AdSDK.createBannerAd("2","801492763",1);t.onLoad(this.onBannerAdLoaded),t.onError(this.onBannerAdError),window.bannerAd=t}},onBannerAdLoaded:function(t){window.bannerAd.show().then(function(){},function(){console.log("Could not show Banner")})},onBannerAdError:function(t){console.log("BannerError: ",JSON.stringify(t))},preFetchInterstitialAd:function(){},onInterstitialLoaded:function(e){console.log("Interstitial Loaded",JSON.stringify(e)),cc.game.emit(t.INTERSTITIAL_FETCH_RESPONSE,{status:0})},onInterstitialError:function(e){console.log("Interstitial Load Error",JSON.stringify(e)),cc.game.emit(t.INTERSTITIAL_FETCH_RESPONSE,{status:1})},showInterstitialAd:function(){cc.log("+PlatformLayer::showInterstitialAd"),cc.audioEngine.pauseMusic(),cc.audioEngine.pauseAllEffects(),cc.director.pause();try{PokiSDK.commercialBreak().then(function(){console.log("Commercial break finished, proceeding to game"),cc.audioEngine.resumeMusic(),cc.audioEngine.resumeAllEffects(),cc.director.resume()})}catch(t){console.log(t),cc.audioEngine.resumeMusic(),cc.audioEngine.resumeAllEffects(),cc.director.resume()}cc.log("-PlatformLayer::showInterstitialAd")},preFetchVideoAd:function(){},onVideoFetchError:function(t){console.log("Video Fetch Error!",JSON.stringify(t)),window.videoAd.destroy(),window.videoAd=null},onVideoAdFetched:function(e){console.log("VideoAdFetched:",JSON.stringify(e)),cc.game.emit(t.AD_FETCH_RESPONSE,{status:0})},showAd:function(e){console.log("+PlatformLayer::showAd()");var o="HomeScreen"!=e;try{o&&PokiSDK.gameplayStop(),PokiSDK.rewardedBreak().then(function(e){o&&PokiSDK.gameplayStart(),e?t.onRewardGained():t.onRewardSkipped()})}catch(t){console.log(t)}console.log("-PlatformLayer::showAd()")},onRewardGained:function(){console.log("Video reward Gained"),cc.game.emit(t.AD_SHOWN_RESPONSE,{status:0})},onRewardSkipped:function(){cc.game.emit(t.AD_SHOWN_RESPONSE,{status:1})},notifyGameStart:function(){console.log("Notify Game Start");try{PokiSDK.gameplayStart()}catch(t){console.log(t)}},trackEvent:function(){console.log("Game track Event",JSON.stringify(arguments))},notifyGameEnd:function(t){console.log("Game End");try{PokiSDK.gameplayStop()}catch(t){console.log(t)}if(this.isInitialized&&window.highScore<t.score){window.highScore=t.score;try{window.localStorage&&(window.localStorage.highScore=t.score)}catch(t){cc.log(t)}}},quitGame:function(t){"undefined"!=typeof GameSDK&&GameSDK.quit(t)}}}(),cc._RF.pop()},{}],PlayerMovement:[function(t,e,o){"use strict";cc._RF.push(e,"89ddc5gz8JESblNk53gsdAH","PlayerMovement");var i=a(t("./Constants")),n=a(t("./Inventory"));function a(t){return t&&t.__esModule?t:{default:t}}var s=t("MyMoveTo"),c=t("CollisionUtils"),r=t("Constants"),l=t("CameraAnimations"),h=i.default.TRAFFIC_STATES,u=38;cc.Class({extends:cc.Component,properties:{lanes:{default:[],visible:!1},normalZ:38,startSpeed:10,boostpulse:{default:null,type:cc.Node},redpulse:{default:null,type:cc.Node},pulselow:{default:0,type:cc.Float},pulsehigh:{default:0,type:cc.Float},pulseratepersec:{default:0,type:cc.Float},crashSounds:{default:[],type:cc.AudioClip},boostSounds:{default:[],type:cc.AudioClip},gameIntroMusic:{default:null,type:cc.AudioClip},gameBackgroundMusic:{default:null,type:cc.AudioClip},turboIndicator:{default:null,type:cc.Node},turboOffMat:{default:null,type:cc.Material},turboOnMat:{default:null,type:cc.Material},coinPickupEffect:{default:[],type:cc.Animation},uiinanimation:{default:[],type:cc.Animation},speedDisplay:{default:null,type:cc.Label},nearmissprefab:{default:null,type:cc.Prefab},nearmisssolo:{default:null,type:cc.Node},coinsolo:{default:null,type:cc.Node},smashsolo:{default:null,type:cc.Node},debugText:{default:null,type:cc.Label},hoverup:!0,hoverheight:{default:0,type:cc.Float},hoverspeed:{default:0,type:cc.Float},boostpulselow:{default:0,type:cc.Float},boostpulsehigh:{default:0,type:cc.Float},boostpulsepersecond:{default:0,type:cc.Float},boostpulseup:!1,combobanner:{default:null,type:cc.Animation},combotext:{default:null,type:cc.Label},combocolors:{default:[],type:cc.Color},combobg:{default:[],type:cc.Node},boostfx:{default:null,type:cc.ParticleSystem},spedlinesfx:{default:null,type:cc.ParticleSystem},nearmissfx:{default:null,type:cc.ParticleSystem},boostfovanim:{default:null,type:cc.Animation},boostpickupfx:{default:null,type:cc.Animation},horizonzoomanim:{default:null,type:cc.Animation},oldcamerarotation:{default:null,type:cc.v3},turboeaseout:!1,turbobuffer:!1,gaNearMisses:{default:0,type:cc.Int},gaTurboPickups:{default:0,type:cc.Int},gaCoinPickups:{default:0,type:cc.Int},gaCollisions:{default:0,type:cc.Int},nearMissNotifCounter:{default:0,type:cc.Int},coinNotifCounter:{default:0,type:cc.Int},smashNotifCounter:{default:0,type:cc.Int},HoodDecalMaterial:{default:null,type:cc.Material},RoofDecalMaterial:{default:null,type:cc.Material},TintMaterial:{default:null,type:cc.Material},DecalSprites:{default:[],type:cc.SpriteFrame}},updateSpeedDisplay:function(){this.speed<0&&(this.speed=0),this.debugText.string=this.speed.toFixed(0)},onLoad:function(){if(this.boostpulselow=255*this.boostpulselow,this.boostpulsehigh=255*this.boostpulsehigh,this.boostpulsepersecond=2*(this.boostpulsehigh-this.boostpulselow),this.lanes=r.GAMEPLAY.LANES,this.boostLevel=-1,this.boostTimer=0,this.boostfx.enabled=!1,this.spedlinesfx.enabled=!1,this.nearmissfx.enabled=!1,this.boostpulse.active=!1,this.oldcamerarotation=cc.v3(-20,0,0),this.turboeaseout=!1,this.laneChangeDuration=(this.lanes[1]-this.lanes[0])/n.default.getUserHandlingSpeed(),this.handlingSpeed=n.default.getUserHandlingSpeed(),this.topSpeed=n.default.getUserTopSpeed(),this.acceleration=n.default.getUserAcceleration(),this.speed=this.startSpeed,this.updateSpeedDisplay(),this.turboIndicator){cc.log("TurboIndicator: "+this.turboIndicator.name),cc.log("TurboIndicator: "+this.turboIndicator.children);var t=this.turboIndicator.children;this.turboIndicators=[];for(var e=0;e<t.length;e++)this.turboIndicators.push(t[e].getComponent(cc.MeshRenderer))}else cc.log("Could not find Indicator");this._score=0,this._scoreHash=btoa(this._score),this.turbosPicked=0,this._turboDuration=0,this._turboEnabled=!1,this._laneMoveDir=0,this._coinPickupEffectIndex=0,this._nearMissNotifIndex=0,this.boostParticles=[20,20,20,20,20],this.curLane=2,this._targetLane=this.curLane,this.laneChangeAngle=10,this.laneChangeAction=new s(1,this.lanes[this.curLane],0,this.normalZ),this.turnAction=cc.rotate3DTo(1,0,this.laneChangeAngle,0),this.turnRest=cc.rotate3DTo(1,0,0,0),this.fbbox=c.createAABB(this.node.getChildByName("fbbox")),this.fbboxOffset=this.node.getChildByName("fbbox").position,this.lbbox=c.createAABB(this.node.getChildByName("lbbox")),this.lbboxOffset=this.node.getChildByName("lbbox").position,this.rbbox=c.createAABB(this.node.getChildByName("rbbox")),this.rbboxOffset=this.node.getChildByName("rbbox").position,this.bbox=c.createAABB(this.node.getChildByName("bbox")),this.bboxOffset=this.node.getChildByName("bbox").position,this.cameraNode=cc.find("/PlayerCamera");var o=cc.find(r.GAME_CONTROLLER_NODE);o.on(r.GAME_EVENTS.TURBO_ACTIVATED,this.onTurboActivated,this),this.sm=o,this.unschedule(this.smashNotifCounterCallBack),o.on(r.GAME_EVENTS.TURBO_PICKED,this.onTurboPicked,this),o.on(r.GAME_EVENTS.COIN_PICKED,this.onCoinPicked,this),this._targetCamFOV=0,this._camFOV_dt=0,this._cityLightsOffset=cc.v2(0,0),this._lightColorIndex=cc.v2(0,3),this._lightColorRatio=cc.v2(0,0),this._lightColorDt=cc.v2(3,1.5),this._lightColors=[(new cc.Color).fromHEX("#d900ff"),(new cc.Color).fromHEX("#0026ff"),(new cc.Color).fromHEX("#00ffcc"),(new cc.Color).fromHEX("#26ff00"),(new cc.Color).fromHEX("#fff200")],this.nearmisssolo=cc.instantiate(this.nearmissprefab),this.nearmisssolo.parent=cc.director.getScene(),this.nearmisssolo.setPosition(this.node.position.x,22.5,200),this.coinsolo=cc.instantiate(this.nearmissprefab),this.coinsolo.parent=cc.director.getScene(),this.coinsolo.setPosition(this.node.position.x,22.5,200),this.coinsolo.getComponent(cc.Label).fontSize=14,this.coinsolo.color=new cc.Color(255,224,0,255),this.smashsolo=cc.instantiate(this.nearmissprefab),this.smashsolo.parent=cc.director.getScene(),this.smashsolo.setPosition(this.node.position.x,22.5,200),this.smashsolo.getComponent(cc.Label).fontSize=50,this.coinNotifCounterCallBack=function(){this.coinNotifCounter=0},this.smashNotifCounterCallBack=function(){this.smashNotifCounter=0}},add2Score:function(t){this._scoreHash===btoa(this._score)&&(this._score+=t,this._scoreHash=btoa(this._score))},onCoinPicked:function(){this.gaCoinPickups+=1;var t=this.coinPickupEffect[this._coinPickupEffectIndex];t.node.stopAllActions(),t.play(),this._coinPickupEffectIndex=(this._coinPickupEffectIndex+1)%this.coinPickupEffect.length,this.unschedule(this.coinNotifCounterCallBack),this.add2Score(r.GAMEPLAY.SCORE_COMPONENTS.COIN_PICKED),this.coinNotifCounter+=r.GAMEPLAY.SCORE_COMPONENTS.COIN_PICKED,this.coinsolo.stopAllActions(),this.coinsolo.parent=null,this.coinsolo.parent=cc.director.getScene(),this._turboEnabled?this.coinsolo.setPosition(.8*this.node.position.x,20,this.node.position.z):this.coinsolo.setPosition(.8*this.node.position.x,15,this.node.position.z),this.coinsolo.opacity=255,this.coinsolo.scale=1.3,this.coinsolo.getComponent(cc.Label).string="+"+this.coinNotifCounter,this.coinsolo.runAction(new cc.spawn(new cc.scaleTo(.15,1),new cc.moveBy(1,new cc.v3(0,5,0)),new cc.sequence(new cc.fadeTo(.25,255),new cc.fadeOut(.75)))),this.scheduleOnce(this.coinNotifCounterCallBack,1)},onTurboPicked:function(t){this.turboIndicator.active=!0,this.gaTurboPickups+=1,this.turbosPicked<3?(this.boostpickupfx.play(),this.scheduleOnce(function(){this.turnonturboindicator()},1.15)):this.turboIndicators[this.turbosPicked-1].setMaterial(0,this.turboOnMat)},turnonturboindicator:function(){this.turboIndicators[this.turbosPicked-1].setMaterial(0,this.turboOnMat)},onTurboActivated:function(){n.default.isAudioMuted()||cc.audioEngine.setMusicVolume(.7),u=-10,this._turboDuration=r.GAMEPLAY.TURBO_DURATION,this.boostfovanim.play(),this.horizonzoomanim.play(),this._turboEnabled=!0,this.turboeaseout=!1,this.turbobuffer=!0,this.topSpeed=n.default.getUserNitroSpeed(),this.speed=this.topSpeed,this.updateSpeedDisplay(),this.boostfx.enabled=!0,this.boostpulse.active=!0,this.redpulse.active=!1,this.boostpulse.opacity=this.boostpulsehigh,this.boostpulseup=!1},deactivateTurbo:function(){n.default.isAudioMuted()||cc.audioEngine.setMusicVolume(1),u=38,this.topSpeed=n.default.getUserTopSpeed(),this.speed=this.topSpeed,this.updateSpeedDisplay(),this.horizonzoomanim.stop(),this.horizonzoomanim.play("horizon_scale").wrapMode=cc.WrapMode.Normal,this.turbosPicked=0,this._turboDuration=0,this._turboEnabled=!1,this.turboIndicator.active=!1,this.boostfx.enabled=!1,this.boostpulse.active=!1,this.scheduleOnce(function(){this.turnturbobufferoff()},.75)},turnturbobufferoff:function(){this.horizonzoomanim.node.scale=1,this.turbobuffer=!1},getDecalSpriteByName:function(t){for(var e=0;e<this.DecalSprites.length;e++)if(this.DecalSprites[e].name==t)return this.DecalSprites[e];return null},start:function(){var t=n.default.getStyleInfo("hood");this.HoodDecalMaterial.setProperty("diffuseColor",cc.color(t.color[0],t.color[1],t.color[2]));var e=this.getDecalSpriteByName(t.decal);e&&this.HoodDecalMaterial.setProperty("diffuseTexture",e.getTexture());var o=n.default.getStyleInfo("roof");this.RoofDecalMaterial.setProperty("diffuseColor",cc.color(o.color[0],o.color[1],o.color[2])),(e=this.getDecalSpriteByName(o.decal))&&this.RoofDecalMaterial.setProperty("diffuseTexture",e.getTexture());var i=n.default.getStyleInfo("body");this.TintMaterial.setProperty("diffuseColor",cc.color(i.color[0],i.color[1],i.color[2]))},animateCameraIntro:function(){n.default.isAudioMuted()?cc.audioEngine.setMusicVolume(0):cc.audioEngine.setMusicVolume(1);cc.audioEngine.playMusic(this.gameBackgroundMusic,!0);for(var t=[],e=l[2],o=0;o<e.length;o++){var i=e[o],a=new s(i[2],1*i[0][0],1*i[0][1],1*i[0][2]),c=new cc.rotate3DTo(i[2],i[1][0],i[1][1],i[1][2]),r=cc.spawn(a,c);t.push(r)}var h=cc.callFunc(this.introAnimDone,this);t.push(h);var u=cc.sequence(t);this.cameraNode.setPosition(10*e[0][0][0],10*e[0][0][1],10*e[0][0][2]),this.cameraNode.runAction(u)},introAnimDone:function(){this.node.emit(r.GAME_EVENTS.INTRO_ANIMATION_FINISHED,"done")},stopLaneChange:function(){this._stopLaneChange=!0},startLaneChange:function(t){var e=t+this.curLane;e>-1&&e<this.lanes.length&&(this._laneMoveDir=t,this.node.stopAllActions(),this.turnAction.initWithDuration(.75*this.laneChangeDuration,0,-1*t*this.laneChangeAngle,0),this.node.runAction(this.turnAction),this._stopLaneChange=!1,this._targetLane=this.curLane+this._laneMoveDir,this._targetLane>this.lanes.length-1?this._targetLane=this.lanes.length-1:this._targetLane<0&&(this._targetLane=0))},animateLaneChange:function(t){var e=t+this.curLane;if(e>-1&&e<this.lanes.length){this.curLane=e,this.laneChangeAction.initWithDuration(this.laneChangeDuration,this.lanes[this.curLane],0,this.normalZ),this.turnAction.initWithDuration(.5*this.laneChangeDuration,0,-1*t*this.laneChangeAngle,0),this.turnRest.initWithDuration(.5*this.laneChangeDuration,0,0,0);var o=new cc.Sequence(this.turnAction,this.turnRest),i=cc.spawn(this.laneChangeAction,o);this.node.stopAllActions(),this.node.runAction(i);var n=this.cameraNode.position,a=new s(this.laneChangeDuration,.5*this.lanes[this.curLane],n.y,n.z);this.cameraNode.runAction(a)}},removeBoost:function(){this.boostLevel<0||(this.boostLevel=-1,this.nearMissNotifCounter=0,this.nearmisssolo.stopAllActions(),this.nearmisssolo.opacity=0,this.spedlinesfx.enabled=!1,this.nearmissfx.enabled=!1,this.combobanner.stop(),this.combobanner.node.x=-155,u=38,this.topSpeed=n.default.getUserTopSpeed())},update:function(t){this._turboEnabled||this.speed!=this.topSpeed&&(this.speed<this.topSpeed?(this.speed+=this.acceleration*t,this.speed=Math.min(this.speed,this.topSpeed)):(this.speed-=this.acceleration*t*.75,this.speed=Math.max(this.speed,this.topSpeed))),this.updateSpeedDisplay();var e=this.node.position;e.x+=this._laneMoveDir*this.handlingSpeed*t,this._turboEnabled||(-1!=this.boostLevel?e.z=e.z+5*t*(u-e.z):e.z=e.z+2*t*(u-e.z)),this._laneMoveDir>0&&e.x>this.lanes[this._targetLane]+.05?(this._targetLane+=this._laneMoveDir,this._targetLane>this.lanes.length-1&&(this._targetLane=this.lanes.length-1)):this._laneMoveDir<0&&e.x<this.lanes[this._targetLane]-.05&&(this._targetLane+=this._laneMoveDir,this._targetLane<0&&(this._targetLane=0)),this._turboEnabled&&(this.boostpulseup?this.boostpulse.opacity+=this.boostpulsepersecond*t*2:this.boostpulse.opacity-=this.boostpulsepersecond*t*2,this.boostpulse.opacity>=this.boostpulsehigh&&(this.boostpulseup=!1),this.boostpulse.opacity<this.boostpulselow&&(this.boostpulseup=!0));var o=this.cameraNode.position;if(this._turboEnabled&&!this.turboeaseout?(o.x=cc.misc.lerp(o.x,.5*e.x,10*t),o.z=cc.misc.lerp(o.z,110,2*t)):(o.x=cc.misc.lerp(o.x,.5*e.x,10*t),o.z=cc.misc.lerp(o.z,95,2*t)),this._turboEnabled&&!this.turboeaseout){var i=cc.misc.lerp(this.oldcamerarotation.x,-20,11*t),n=cc.misc.lerp(this.oldcamerarotation.y,-e.x/6,11*t),a=cc.misc.lerp(this.oldcamerarotation.z,-e.x/3,11*t);this.cameraNode.eulerAngles=cc.v3(i,n,a),this.oldcamerarotation=this.cameraNode.eulerAngles}else{i=cc.misc.lerp(this.oldcamerarotation.x,-20,11*t),n=cc.misc.lerp(this.oldcamerarotation.y,0,11*t),a=cc.misc.lerp(this.oldcamerarotation.z,0,11*t);this.cameraNode.eulerAngles=cc.v3(i,n,a),this.oldcamerarotation=this.cameraNode.eulerAngles}if(this.cameraNode.setPosition(o),e.x<this.lanes[0]?(e.x=this.lanes[0],this.curLane=0,this._stopLaneChange=!0):e.x>this.lanes[4]&&(e.x=this.lanes[4],this.curLane=4,this._stopLaneChange=!0),this._stopLaneChange){this.node.stopAllActions(),this.curLane=this._targetLane;var s=Math.abs(this.lanes[this.curLane]-e.x)/20;s*=this.laneChangeDuration,this.laneChangeAction.initWithDuration(s,this.lanes[this.curLane],0,this.node.position.z),cc.log("Lane Details",this.curLane,this.lanes[this.curLane]),this.turnAction.initWithDuration(s,0,-1*this._laneMoveDir*this.laneChangeAngle,0),this.turnRest.initWithDuration(4*this.laneChangeDuration,0,0,0),this.turnRest.easing(cc.easeBackOut());var c=new cc.spawn(this.laneChangeAction,this.turnAction),l=new cc.Sequence(c,this.turnRest);this.node.runAction(l),this._laneMoveDir=0,this._stopLaneChange=!1}if(this.node.position=e,this.boostLevel>-1&&(this.boostTimer-=t,this.boostTimer<=0&&this.removeBoost()),this._turboEnabled){this._turboDuration-=t;var h=this._turboDuration/r.GAMEPLAY.TURBO_DURATION*100,d=Math.ceil(h/33);d<this.turboIndicators.length&&d>-1&&this.turboIndicators[d].setMaterial(0,this.turboOffMat),this._turboDuration<1&&(this.turboeaseout=!0),this._turboDuration<0&&(this.deactivateTurbo(),this.turboeaseout=!1)}0!=this._camFOV_dt&&(this.cameraNode.getComponent(cc.Camera).fov+=t*this._camFOV_dt,Math.abs(this.cameraNode.getComponent(cc.Camera).fov-this._targetCamFOV)<=1&&(this._camFOV_dt=0,this.cameraNode.getComponent(cc.Camera).fov=this._targetCamFOV)),this.node.position.add(this.fbboxOffset,this.fbbox.center),this.node.position.add(this.lbboxOffset,this.lbbox.center),this.node.position.add(this.rbboxOffset,this.rbbox.center),this.node.position.add(this.bboxOffset,this.bbox.center)},isCheckpointCrossed:function(t){var e=c.createAABB(t);return c.isOverlapping(e,this.bbox)},checkRacerCollision:function(t){var e=t.getComponent("RacerCar"),o=e.bbox;if(e.stateMachine.curStateName==i.default.RACER_STATES.DEFAULT)if((this._turboEnabled||this.turbobuffer)&&c.isOverlapping(this.bbox,o))e.stateMachine.changeState(i.default.RACER_STATES.THRASHED);else if(c.isOverlapping(this.lbbox,o)){cc.log("Collision: Left Collision box"),e.stateMachine.changeState(i.default.RACER_STATES.THRASHED);var n=Math.floor(Math.random()*this.crashSounds.length);cc.audioEngine.playEffect(this.crashSounds[n],!1)}else if(c.isOverlapping(this.rbbox,o)){cc.log("Collision: Right Collision box"),e.stateMachine.changeState(i.default.RACER_STATES.THRASHED);n=Math.floor(Math.random()*this.crashSounds.length);cc.audioEngine.playEffect(this.crashSounds[n],!1)}else if(c.isOverlapping(this.bbox,o)){cc.log("Collision: Collision detected"),o.center.z>this.bbox.center.z?this.moveDirection=2:this.gaCollisions+=1,this.speed=0,this.updateSpeedDisplay(),this.removeBoost();n=Math.floor(Math.random()*this.crashSounds.length);cc.audioEngine.playEffect(this.crashSounds[n],!1),this.sm.emit(i.default.GAME_EVENTS.CAR_HIT,t)}},checkCollision:function(t){var e=t.getComponent(r.AI_COMPONENT),o=c.createAABB(t.getChildByName("bbox"));if(this._turboEnabled||this.turbobuffer){if(!1===t.getComponent(h.THRASHED).enabled&&c.isOverlapping(this.bbox,o)){cc.log("Collision: Collision detected"),e.setState(h.THRASHED),this.sm.emit(i.default.GAME_EVENTS.CAR_THRASHED,t);var a=Math.floor(Math.random()*this.crashSounds.length);cc.audioEngine.playEffect(this.crashSounds[a],!1),this._turboEnabled&&(this.add2Score(r.GAMEPLAY.SCORE_COMPONENTS.CAR_SMASHED),this.smashNotifCounter+=r.GAMEPLAY.SCORE_COMPONENTS.CAR_SMASHED,this.smashsolo.stopAllActions(),this.smashsolo.parent=null,this.smashsolo.parent=cc.director.getScene(),this.smashsolo.setPosition(this.node.position.x,70,-125),this.smashsolo.opacity=255,this.smashsolo.scale=1.5,this.smashsolo.getComponent(cc.Label).string="+"+this.smashNotifCounter,this.smashsolo.runAction(new cc.spawn(new cc.scaleTo(.15,1),new cc.moveBy(1,new cc.v3(0,15,0)),new cc.sequence(new cc.fadeTo(.25,255),new cc.fadeOut(.75)))),this.scheduleOnce(this.smashNotifCounterCallBack,6))}}else if(!e.nearMissCounted&&c.isOverlapping(this.fbbox,o))e.nearMissCounted=!0,this.boostLevel+=1,this.gaNearMisses+=1,this.boostTimer=r.GAMEPLAY.BOOST_COOLDOWN,this.boostLevel>=r.GAMEPLAY.BOOST_BUMP.length&&(this.boostLevel=r.GAMEPLAY.BOOST_BUMP.length-1),this.combobanner.play(),this.combotext.string=this.boostLevel+1+"x",this.combobg[0].color=this.combocolors[this.boostLevel],this.combobg[1].color=this.combocolors[this.boostLevel],this.combobanner.node.scaleX=1+.1*this.boostLevel,this.combobanner.node.scaleY=1+.1*this.boostLevel,u=Math.max(this.node.position.z-8,-10),this.spedlinesfx.enabled=!0,this.nearmissfx.enabled=!0,this.nearmissfx.node.scaleX=.45*(this.boostLevel+1),this.add2Score(r.GAMEPLAY.SCORE_COMPONENTS.NEAR_MISS),this.nearMissNotifCounter+=r.GAMEPLAY.SCORE_COMPONENTS.NEAR_MISS,this.topSpeed=n.default.getUserTopSpeed()+r.GAMEPLAY.BOOST_BUMP[this.boostLevel],this.speed+=r.GAMEPLAY.BOOST_BUMP[0],this.updateSpeedDisplay(),cc.audioEngine.playEffect(this.boostSounds[0],!1),this.nearmisssolo.stopAllActions(),this.nearmisssolo.parent=null,this.nearmisssolo.parent=cc.director.getScene(),this.nearmisssolo.setPosition(this.node.position.x,22.5,this.node.position.z),this.nearmisssolo.opacity=255,this.nearmisssolo.scale=1.3,this.nearmisssolo.getComponent(cc.Label).string="+"+this.nearMissNotifCounter,this.nearmisssolo.getComponent(cc.Label).fontSize=12+this.boostLevel,this.nearmisssolo.runAction(new cc.spawn(new cc.scaleTo(.15,1),new cc.moveBy(1.5,new cc.v3(0,5,0)),new cc.sequence(new cc.fadeTo(.5,255),new cc.fadeOut(1))));else if(!1===t.getComponent(h.HIT).enabled){var s=t.getComponent(h.HIT);if(c.isOverlapping(this.lbbox,o)){cc.log("Collision: Left Collision box"),s.moveDirection=-1,e.setState(h.HIT);a=Math.floor(Math.random()*this.crashSounds.length);cc.audioEngine.playEffect(this.crashSounds[a],!1)}else if(c.isOverlapping(this.rbbox,o)){cc.log("Collision: Right Collision box"),s.moveDirection=1,e.setState(h.HIT);a=Math.floor(Math.random()*this.crashSounds.length);cc.audioEngine.playEffect(this.crashSounds[a],!1)}else if(c.isOverlapping(this.bbox,o)){cc.log("Collision: Collision detected"),o.center.z>this.bbox.center.z?this.moveDirection=2:(s.moveDirection=0,this.gaCollisions+=1),e.setState(h.HIT),this.speed=0,this.updateSpeedDisplay(),this.removeBoost();a=Math.floor(Math.random()*this.crashSounds.length);cc.audioEngine.playEffect(this.crashSounds[a],!1),this.sm.emit(i.default.GAME_EVENTS.CAR_HIT,t)}}}}),cc._RF.pop()},{"./Constants":"Constants","./Inventory":"Inventory",CameraAnimations:"CameraAnimations",CollisionUtils:"CollisionUtils",Constants:"Constants",MyMoveTo:"MyMoveTo"}],RacerCar:[function(t,e,o){"use strict";cc._RF.push(e,"ea6fcu6IZdPiJzueepbrbuG","RacerCar");var i=t("../Constants"),n=u(i),a=u(t("../customization/MenuStateMachine")),s=u(t("./RacerDefault")),c=u(t("./RacerThrashed")),r=u(t("../CollisionUtils")),l=u(t("./RacerWaiting")),h=u(t("./RacerTurbo"));function u(t){return t&&t.__esModule?t:{default:t}}var d=n.default.TRAFFIC_STATES,f=n.default.RACER_STATES;cc.Class({extends:cc.Component,properties:{EmoteMaterial:{type:cc.Material,default:null},TintMaterial:{type:cc.Material,default:null},RoofDecalMaterial:{type:cc.Material,default:null},HoodDecalMaterial:{type:cc.Material,default:null},TurboFX:{type:cc.ParticleSystem,default:null},emote_node:{type:cc.Node,default:null},racerStandingText:{type:cc.Label,default:null},emote:{visible:!1,set:function(t){if(cc.log(t),t in this.emoteOffsets){var e=.1*this.emoteOffsets[t][0],o=.33*this.emoteOffsets[t][1];this.EmoteMaterial.setProperty("mainOffset",cc.v2(e,o)),this._emote=t;var i=this.emote_node,n=this.racerStandingText.node;i.active=!0,i.scale=0,n.active=!1,this._tween&&this._tween.stop(),this._tween=cc.tween(this.emote_node).to(.25,{scale:20},{easing:"expoOut"}).delay(2).to(.25,{scale:0},{easing:"expoOut"}).call(function(){cc.log("Emote_hidden"),i.active=!1,n.active=!0}).start()}},get:function(){return this._emote}},emoteOffsets:{visible:!1,default:{}}},onLoad:function(){this.emoteOffsets={broken_heart:[4,0],three_dots:[3,0],two_dots:[2,0],heart:[5,0],two_hearts:[6,0],two_exclam:[7,0],red_exclaim:[8,0],question:[9,0],zz:[1,1],sad_face:[4,1],angry_face:[5,1],surprised:[6,1],one_tensed:[0,2],two_tensed:[1,2],annoyed:[2,2],scolding:[4,2],no:[5,2],laugh:[8,2],annoyed_1:[9,2]},this.sceneMovement=cc.find(n.default.GAME_CONTROLLER_NODE),this.sm=this.sceneMovement.getComponent(n.default.ENV_COMPONENT),this.player=cc.find(n.default.PLAYER_NODE),this.pm=this.player.getComponent(n.default.PLAYER_COMPONENT),this.bbox=r.default.createAABB(this.node.getChildByName("bbox")),this.stateMachine=new a.default(this),this.stateMachine.states[f.DEFAULT]=new s.default(this.stateMachine),this.stateMachine.states[f.THRASHED]=new c.default(this.stateMachine),this.stateMachine.states[f.WAITING]=new l.default(this.stateMachine),this.stateMachine.states[f.TURBO]=new h.default(this.stateMachine)},start:function(){this.racerStanding=15,this.resetCar();var t=this.stateMachine;this.sceneMovement.on(n.default.GAME_EVENTS.TURBO_PICKED,function(e){t.onEvent(n.default.GAME_EVENTS.TURBO_PICKED,e)}),this.sceneMovement.on(n.default.GAME_EVENTS.TURBO_ACTIVATED,function(e){t.onEvent(n.default.GAME_EVENTS.TURBO_ACTIVATED,e)}),this.sceneMovement.on(n.default.GAME_EVENTS.CHECKPOINT_REACHED,function(e){t.onEvent(n.default.GAME_EVENTS.CHECKPOINT_REACHED,e)}),this.sceneMovement.on(n.default.GAME_EVENTS.CAR_THRASHED,function(e){t.onEvent(n.default.GAME_EVENTS.CAR_THRASHED,e)}),this.sceneMovement.on(n.default.GAME_EVENTS.CAR_HIT,function(e){t.onEvent(n.default.GAME_EVENTS.CAR_HIT,e)}),this.sceneMovement.on(n.default.GAME_EVENTS.AIRACER_TURBO_PICKED,function(e){t.onEvent(n.default.GAME_EVENTS.AIRACER_TURBO_PICKED,e)}),this.stateMachine.changeState(f.WAITING)},resetCar:function(){this.speed=10,this.accel=100,this.nearMissCounted=!1,this.racerStanding>1&&(this.racerStanding-=1),this.racerStandingText.string=""+this.racerStanding;var t=cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())),e=this.pm.DecalSprites[Math.floor(Math.random()*this.pm.DecalSprites.length)];this.HoodDecalMaterial.setProperty("diffuseColor",t),this.HoodDecalMaterial.setProperty("diffuseTexture",e.getTexture()),t=cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())),e=this.pm.DecalSprites[Math.floor(Math.random()*this.pm.DecalSprites.length)],this.RoofDecalMaterial.setProperty("diffuseColor",t),this.RoofDecalMaterial.setProperty("diffuseTexture",e.getTexture()),t=cc.color(Math.floor(255*Math.random()),Math.floor(255*Math.random()),Math.floor(255*Math.random())),this.TintMaterial.setProperty("diffuseColor",t)},setState:function(t){},checkCollision:function(t){var e=t.getComponent(n.default.AI_COMPONENT),o=r.default.createAABB(t.getChildByName("bbox"));!1===t.getComponent(d.THRASHED).enabled&&r.default.isOverlapping(this.bbox,o)&&(cc.log("Racer Collision: Collision detected"),this.stateMachine.onEvent(i.GAME_EVENTS.AIRACER_TRAFFIC_COLLIDED,e))},update:function(t){this.stateMachine.update(t)}}),cc._RF.pop()},{"../CollisionUtils":"CollisionUtils","../Constants":"Constants","../customization/MenuStateMachine":"MenuStateMachine","./RacerDefault":"RacerDefault","./RacerThrashed":"RacerThrashed","./RacerTurbo":"RacerTurbo","./RacerWaiting":"RacerWaiting"}],RacerDefault:[function(t,e,o){"use strict";cc._RF.push(e,"f63a8/X04RHArkbZCRGebRA","RacerDefault"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),n=t("../Constants"),a=c(n),s=c(t("../customization/MenuState"));function c(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=a.default.RACER_STATES,d=function(t){function e(){return r(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return h(e,s.default),i(e,[{key:"initState",value:function(t,e){}},{key:"onEnter",value:function(){cc.log("+RacerDefault:")}},{key:"onEvent",value:function(t,e){switch(t){case n.GAME_EVENTS.CHECKPOINT_REACHED:var o=["angry_face","surprised","scolding","no"];this.owner.emote=o[Math.floor(Math.random()*o.length)];break;case n.GAME_EVENTS.TURBO_PICKED:var i=["one_tensed","two_tensed","heart_break","sad_face"];this.owner.emote=i[Math.floor(Math.random()*i.length)];break;case n.GAME_EVENTS.TURBO_ACTIVATED:this.owner.emote="two_tensed";break;case n.GAME_EVENTS.TURBO_DEACTIVATED:break;case n.GAME_EVENTS.CAR_HIT:var a=["laugh","heart","two_hearts","question"];this.owner.emote=a[Math.floor(Math.random()*a.length)];break;case n.GAME_EVENTS.CAR_THRASHED:break;case n.GAME_EVENTS.AIRACER_TURBO_COLLIDED:var s=e[0];e[1].put(s),this.sm.changeState(u.TURBO);break;case n.GAME_EVENTS.AIRACER_COIN_COLLIDED:var c=e[0];e[1].put(c);break;case n.GAME_EVENTS.AIRACER_TRAFFIC_COLLIDED:e.setState(n.TRAFFIC_STATES.THRASHED)}}},{key:"onUpdate",value:function(t){this.owner.speed+=this.owner.accel,this.owner.speed>=a.default.GAMEPLAY.PLAYER_TOP_SPEED&&(this.owner.speed=a.default.GAMEPLAY.PLAYER_TOP_SPEED);var e=t*(this.owner.sm.speed-this.owner.speed),o=this.owner.node.position;o.z+=e,o.y=o.y,this.owner.node.position=o,this.owner.bbox.center=this.owner.node.position,o.z>a.default.RENDERING.ZMIN&&(this.owner.sceneMovement.emit(n.GAME_EVENTS.AIRACER_OVERTAKEN,this.owner),this.sm.changeState(u.WAITING))}},{key:"onExit",value:function(){cc.log("-RacerDefault")}}]),e}();o.default=d,e.exports=o.default,cc._RF.pop()},{"../Constants":"Constants","../customization/MenuState":"MenuState"}],RacerThrashed:[function(t,e,o){"use strict";cc._RF.push(e,"12bf6YL05ZHoZGRyFSWus0/","RacerThrashed"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),n=t("../Constants"),a=c(n),s=c(t("../customization/MenuState"));function c(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=a.default.RACER_STATES,d=function(t){function e(){return r(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return h(e,s.default),i(e,[{key:"initState",value:function(t,e){}},{key:"onEnter",value:function(){this.th=this.owner.node.getComponent(a.default.TRAFFIC_STATES.THRASHED),this.th.enabled=!0,this.emote="annoyed_1",cc.log("+RacerThrashed"),this.owner.sceneMovement.emit(n.GAME_EVENTS.AIRACER_THRASHED,this.owner)}},{key:"onEvent",value:function(t,e){}},{key:"onUpdate",value:function(t){this.owner.node.position.z>a.default.RENDERING.ZMIN&&(this.owner.node.stopAllActions(),this.th.enabled=!1,this.sm.changeState(u.WAITING))}},{key:"onExit",value:function(){cc.log("-RacerThrashed")}}]),e}();o.default=d,e.exports=o.default,cc._RF.pop()},{"../Constants":"Constants","../customization/MenuState":"MenuState"}],RacerTurbo:[function(t,e,o){"use strict";cc._RF.push(e,"f0904AEDvlPDIKhlL8wkcaC","RacerTurbo"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),n=t("../Constants"),a=c(n),s=c(t("../customization/MenuState"));function c(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var u=function(t){function e(t){return r(this,e),l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return h(e,s.default),i(e,[{key:"initState",value:function(t,e){}},{key:"onEnter",value:function(){var t=a.default.GAMEPLAY.UPGRADES[2],e=window.userData.upgrades[2];this.owner.sm.speed=t.values[e],this.duration=n.GAMEPLAY.TURBO_DURATION,this.owner.TurboFX.enabled=!0}},{key:"onEvent",value:function(t,e){switch(t){case n.GAME_EVENTS.AIRACER_TRAFFIC_COLLIDED:e.setState(n.TRAFFIC_STATES.THRASHED);break;case n.GAME_EVENTS.AIRACER_COIN_COLLIDED:var o=e[0];e[1].put(o);break;case n.GAME_EVENTS.AIRACER_TURBO_COLLIDED:var i=e[0];e[1].put(i)}}},{key:"onUpdate",value:function(t){this.duration-=t,this.duration<=0&&this.sm.changeState(n.RACER_STATES.DEFAULT);var e=t*(this.owner.sm.speed-this.owner.speed),o=this.owner.node.position;o.z+=e,o.y=o.y,this.owner.node.position=o,this.owner.bbox.center=this.owner.node.position}},{key:"onExit",value:function(){this.owner.TurboFX.enabled=!1,this.owner.speed=a.default.GAMEPLAY.PLAYER_TOP_SPEED}}]),e}();o.default=u,e.exports=o.default,cc._RF.pop()},{"../Constants":"Constants","../customization/MenuState":"MenuState"}],RacerWaiting:[function(t,e,o){"use strict";cc._RF.push(e,"02066/XzztEe637CP/Db+Jq","RacerWaiting"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),n=s(t("../customization/MenuState")),a=s(t("../Constants"));function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=a.default.RACER_STATES,u=function(t){function e(){return c(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return l(e,n.default),i(e,[{key:"initState",value:function(t,e){}},{key:"onEnter",value:function(){this.rootNode=this.owner.node.getChildByName("RootNode"),this.emoteNode=this.owner.node.getChildByName("Emote"),this.rootNode.active=!1,this.emoteNode.active=!1,this.owner.node.stopAllActions(),cc.log("+RacerWaiting")}},{key:"onEvent",value:function(t,e){switch(t){case a.default.GAME_EVENTS.CHECKPOINT_REACHED:this.rootNode.active=!0,this.emoteNode.active=!0,this.owner.racerStandingText.node.active=!0,this.emoteNode.scale=0,this.owner.node.stopAllActions();var o=a.default.GAMEPLAY.LANES[Math.floor(Math.random()*a.default.GAMEPLAY.LANES.length)];this.owner.node.position=cc.v3(o,0,-600),this.owner.resetCar(),this.sm.changeState(h.DEFAULT)}}},{key:"onUpdate",value:function(t){}},{key:"onExit",value:function(){cc.log("-RacerWaiting")}}]),e}();o.default=u,e.exports=o.default,cc._RF.pop()},{"../Constants":"Constants","../customization/MenuState":"MenuState"}],RoofDecalState:[function(t,e,o){"use strict";cc._RF.push(e,"df68dc3rFpJWJfU0egFftcP","RoofDecalState"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),n=s(t("../Constants")),a=s(t("../Inventory"));function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var h=t("MenuState"),u=t("MenuConstants"),d=u.MS,f=u.ME,p=function(t){function e(){return c(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return l(e,h),i(e,[{key:"initState",value:function(t,e){this.anim2Play="camera_roof",t==d.HOOD_DECAL_PAINT&&(this.anim2Play="camera_hood2roof")}},{key:"onEnter",value:function(){this.TintMaterial=this.sm.owner.RoofDecalMaterial,this.cp=this.sm.owner.ColorPicker,this.dp=this.sm.owner.DecalPicker,this.cp.active=!0,this.dp.active=!0,this.exitButton=this.cp.parent.parent.getChildByName("ExitCustomization"),this.exitButton.active=!0,this.sm.owner.CameraAnimation.play(this.anim2Play).wrapMode=cc.WrapMode.Normal,this.sm.owner.ButtonSprites[1].color=this.sm.owner.ActiveButtonColor,this.roofStyle=Object.assign({},a.default.getStyleInfo("roof"));for(var t=this.owner.DecalListContainer.children,e=0;e<t.length;e++)t[e].children[2].getComponent(cc.Label).string=""+n.default.GAMEPLAY.STYLES_COSTS.ROOF_DECAL_COST,a.default.getUserCoins()<n.default.GAMEPLAY.STYLES_COSTS.ROOF_DECAL_COST&&(t[e].children[2].color=cc.color(249,49,49))}},{key:"confirmBeforeExit",value:function(t){if(this.exitState=t,this.canBuyDecal()){var e=this.owner.getDecalSpriteByName(this.roofStyle.decal);this.owner.decalPreview.spriteFrame=e,this.owner.showBuyConfirmation()}else this.resetDecal(),this.sm.changeState(t)}},{key:"onEvent",value:function(t,e){switch(t){case f.SLIDER_MOVED:case f.BLACK_CLICKED:case f.WHITE_CLICKED:this.TintMaterial.setProperty("diffuseColor",e),this.roofStyle.color=[e.r,e.g,e.b];break;case f.PAINT_CLICKED:this.dp.active=!1,this.confirmBeforeExit(d.CAR_PAINT);break;case f.HOOD_CLICKED:this.confirmBeforeExit(d.HOOD_DECAL_PAINT);break;case f.ROOF_CLICKED:case f.BACK_CLICKED:this.dp.active=!1,this.cp.active=!1,this.confirmBeforeExit(d.DEFAULT);break;case f.DECAL_SELECTED:this.TintMaterial.setProperty("diffuseTexture",this.sm.owner.DecalSprites[e].getTexture()),this.roofStyle.decal=this.sm.owner.DecalSprites[e].name;break;case f.BUY_CLICKED:a.default.addCoins(-n.default.GAMEPLAY.STYLES_COSTS.ROOF_DECAL_COST),this.owner.showCoinChangeAnimation(-n.default.GAMEPLAY.STYLES_COSTS.ROOF_DECAL_COST),this.owner.hideBuyConfirmation(),this.sm.changeState(this.exitState);break;case f.CANCEL_CLICKED:this.resetDecal(),this.owner.hideBuyConfirmation(),this.sm.changeState(this.exitState)}}},{key:"canBuyDecal",value:function(){var t=a.default.getUserCoins();return a.default.getStyleInfo("roof").decal!=this.roofStyle.decal&&t>=n.default.GAMEPLAY.STYLES_COSTS.ROOF_DECAL_COST}},{key:"resetDecal",value:function(){var t=a.default.getStyleInfo("roof");this.roofStyle.decal=t.decal;var e=this.owner.getDecalSpriteByName(this.roofStyle.decal);this.TintMaterial.setProperty("diffuseTexture",e.getTexture())}},{key:"onExit",value:function(){this.exitButton.active=!1,this.sm.owner.ButtonSprites[1].color=cc.Color.WHITE,a.default.setStyleInfo("roof",this.roofStyle),a.default.save()}}]),e}();o.default=p,e.exports=o.default,cc._RF.pop()},{"../Constants":"Constants","../Inventory":"Inventory",MenuConstants:"MenuConstants",MenuState:"MenuState"}],SceneMovement:[function(t,e,o){"use strict";cc._RF.push(e,"7465dOolIZJXKUoGNdhlrLo","SceneMovement");var i=t("./Constants"),n=function(t){return t&&t.__esModule?t:{default:t}}(t("./Inventory"));var a=t("Constants"),s=t("CollisionUtils"),c=a.GAME_STATES,r=1,l=0,h=PlatformLayer,u=Date.now();cc.Class({extends:cc.Component,properties:{segments:{default:[],type:cc.Node},speed:{default:10,type:cc.Float},zLimit:{default:800},zMax:{default:1200},scorepointersprefab:{default:null,type:cc.Prefab},carTraffic:{default:[],type:cc.Prefab},truckTraffic:{default:[],type:cc.Prefab},turboPrefab:{default:null,type:cc.Prefab},coinPrefab:{default:null,type:cc.Prefab},coinsLabel:{default:null,type:cc.Label},coinPickupSound:{default:null,type:cc.AudioClip},checkpointSound:{default:null,type:cc.AudioClip},timerLabel:{default:null,type:cc.Label},timeoutEffectSound:{default:null,type:cc.AudioClip},turboEffectSound:{default:null,type:cc.AudioClip},turboPickupSound:{default:null,type:cc.AudioClip},pauseScreen:{default:null,type:cc.Node},gameOverScreen:{default:null,type:cc.Node},scoreDisplay:{default:null,type:cc.Label},redpulse:{default:null,type:cc.Node},boostpulse:{default:null,type:cc.Node},redpulseanimation:{default:null,type:cc.Animation},timertextanimation:{default:null,type:cc.Animation},gameoverscoretext:{default:null,type:cc.Label},gameoverhighscoretext:{default:null,type:cc.Label},pauseui:{default:null,type:cc.Node},toastNode:{default:null,type:cc.Animation},toastMessage:{default:null,type:cc.Label},debugText:{default:null,type:cc.Label},adAutoTimerValue:{default:null,type:cc.Int},adAutoTimerLabel:{default:null,type:cc.Label},adAutoTimerBase:{default:null,type:cc.Node},adAutoTimerTick:{default:null,type:cc.Node},didAutoPlay:{default:null,type:cc.Int},trafficManager:{default:0,type:cc.Float},gaRevivesUsed:{default:0,type:cc.Int},gaPostReviveDistanceCovered:{default:0,type:cc.Float},gaRaceTime:{default:0,type:cc.Float},gaAdChoiceChances:{default:0,type:cc.Float},gaAdDecisionTimeAverage:{default:0,type:cc.Float},gaRoomType:{default:"No",type:cc.String},shouldspawnturbo:!1,exitType:{default:"over",type:cc.String},wasAdClaimed:{default:0,type:cc.Int},Overlay:{default:null,type:cc.Node},aiRacer:{default:null,type:cc.Node}},setAudioVolume:function(t){cc.audioEngine.setEffectsVolume(t),cc.audioEngine.setMusicVolume(t)},onLoad:function(){n.default.load(),n.default.isAudioMuted()?this.setAudioVolume(0):this.setAudioVolume(1),this.reviveScreen=cc.find("/Canvas/AdvertisingScreen"),this.trafficManager=0,this._envType=r,this._envChunkCount=0,this.autoTimerGo=function(){cc.log("+autoTimerGo"),1==this.adAutoTimerValue?0==a.GAMEPLAY.AD_AUTO_EXIT?(this.didAutoPlay=1,this.watchAdButtonClicked()):this.onGameOver():(this.adAutoTimerValue-=1,this.adAutoTimerLabel.string=this.adAutoTimerValue,this.adAutoTimerTick.runAction(new cc.RotateBy(1,360))),cc.log("-autoTimerGo")}},timeOutToastFinished:function(){this._gameState==c.WAITING_REVIVE&&(this.revivesAvailable>0?-1==a.GAMEPLAY.AD_AUTO_TIMER?(this.reviveScreen.active=!0,this.gaAdChoiceChances+=1,h.trackEvent("gameAdShown",{gameID:"0"})):0==a.GAMEPLAY.AD_AUTO_TIMER?(this.gaAdChoiceChances+=1,h.trackEvent("gameAdShown",{gameID:"0"}),this.watchAdButtonClicked()):(this.adAutoTimerValue=a.GAMEPLAY.AD_AUTO_TIMER,this.adAutoTimerLabel.string=a.GAMEPLAY.AD_AUTO_TIMER,this.adAutoTimerBase.active=!0,this.adAutoTimerTick.active=!0,this.adAutoTimerTick.rotation=85,this.adAutoTimerTick.runAction(new cc.RotateBy(1,360)),this.didAutoPlay=0,this.schedule(this.autoTimerGo,1,this.adAutoTimerValue,0),this.reviveScreen.active=!0,this.gaAdChoiceChances+=1,h.trackEvent("gameAdShown",{gameID:"0"})):this.node.emit(a.GAME_EVENTS.GAME_OVER))},watchAdButtonClicked:function(){cc.log("+watchAdButtonClicked"),this.reviveScreen.active=!1,cc.audioEngine.pauseMusic(),this.revivesAvailable-=1,h.showAd("ReviveScreen");var t=new Date,e=t.getFullYear()+"-"+(parseInt(t.getMonth())+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds();h.trackEvent("gameAdClicked",{position:"death",timeStamp:e,autoPlayed:this.didAutoPlay}),cc.log("-watchAdButtonClicked")},restartButtonClicked:function(){cc.director.loadScene("gameplay"),this.adLoaded=!0,h.showInterstitialAd()},homeButtonClicked:function(){cc.director.preloadScene("garage",function(){cc.director.loadScene("garage")})},togglePause:function(){if(this._gameState!==c.STARTED){if(this._gameState==c.PAUSED){this.pauseScreen.active=!1,this._gameState=c.STARTED,cc.audioEngine.resumeMusic(),cc.audioEngine.resumeAllEffects(),cc.director.resume(),this.pauseui.active=!0;try{PokiSDK.gameplayStart()}catch(t){cc.log(t)}}}else{this.pauseui.active=!1,this._gameState=c.PAUSED,this.pauseScreen.active=!0,cc.audioEngine.pauseMusic(),cc.audioEngine.pauseAllEffects();try{PokiSDK.gameplayStop()}catch(t){cc.log(t)}cc.director.pause()}},getGameState:function(){return this._gameState},getAvgFPS:function(){var t=(Date.now()-this._startFPSTimeStamp)/1e3;return cc.director.getTotalFrames()/t},start:function(){this.Overlay.active=!0;var t=this.Overlay;cc.tween(this.Overlay).to(.25,{opacity:0}).call(function(){t.active=!1}).start(),this._startFPSTimeStamp=Date.now(),this._gameState=c.LOADING,this._gpcHash=btoa(JSON.stringify(a.GAMEPLAY.SCORE_COMPONENTS)),0==this.segments.length&&cc.log("Please assign segments"),0==this.carTraffic.length&&cc.log("Please assign some ai prefabs"),this.aiCarPool=new cc.NodePool(a.AI_COMPONENT),this.aiCars=[];for(var e=0;e<a.RENDERING.TRAFFIC_POOL_SIZE;e++){var o=[this.carTraffic,this.carTraffic,this.carTraffic,this.carTraffic,this.carTraffic,this.truckTraffic][Math.floor(6*Math.random())],s=Math.floor(Math.random()*o.length),r=cc.instantiate(o[s]);this.aiCarPool.put(r),this.aiCars.push(r)}this.coinPool=new cc.NodePool(a.COIN_COMPONENT),this.coins=[];for(e=0;e<a.RENDERING.COIN_POOL_SIZE;e++){var l=cc.instantiate(this.coinPrefab);this.coinPool.put(l),this.coins.push(l)}this.turboPool=new cc.NodePool(a.COIN_COMPONENT),this.turbos=[];for(e=0;e<a.RENDERING.TURBO_POOL_SIZE;e++){var u=cc.instantiate(this.turboPrefab);this.turboPool.put(u),this.turbos.push(u)}this.aiRacerMovement=this.aiRacer.getComponent("RacerCar"),this.playerCar=cc.find(a.PLAYER_NODE),this.playerMovement=this.playerCar.getComponent(a.PLAYER_COMPONENT),this.checkpoint=cc.find("/checkpoint"),this._coinsCollected=0,this._totalDistance=100,this.gaPostReviveDistanceCovered=0,this._notifyCheckpoint=!1,this._totalChunks=0,this._numCheckPoints=0,this._spawnZOffset=[-800,-888,-976,-1064,-1152,-1240,-1328,-1416,-1504],this._timerConfig=[30,25,22,22,18,18,17,17,16,14,14,14,14,14],this._spawnProbability=[[0,3,1,0,0],[1,6,1,0,0],[2,6,.8,.2,0],[3,6,.8,.2,0],[4,7,.7,.3,0],[5,7,.7,.3,0],[6,7,.7,.3,0],[7,7,1,0,0],[8,8,1,0,0],[9,8,1,0,0],[10,8,1,0,0],[11,8,1,0,0],[12,8,1,0,0],[13,8,1,0,0]],this.timerLabel.node.active=!1,void 0==window.isFirst&&(window.isFirst=!1,h.initGame(),this.adLoaded=!0),this.playerMovement.animateCameraIntro(),this._gameState=c.ANIMATING,h.notifyGameStart(),this.revivesAvailable=a.GAMEPLAY.MAX_REVIVES_ALLOWED,cc.game.on(h.AD_FETCH_RESPONSE,this.adAvailabilityCheck,this),cc.game.on(h.AD_SHOWN_RESPONSE,this.adRewards,this),cc.game.on(h.VOLUME_SET,this.setAudioVolume,this),cc.game.on(h.DEVICE_EVENT,this.onDeviceEvent,this),this.playerCar.on(i.GAME_EVENTS.INTRO_ANIMATION_FINISHED,this.startGame,this),this._nextTurboSpawn=a.GAMEPLAY.CHUNK_COUNT_FIRST_TIME_TURBO,this.node.on(i.GAME_EVENTS.CHECKPOINT_REACHED,this.onCheckpointReached,this),this.node.on(i.GAME_EVENTS.AIRACER_THRASHED,this.onRacerThrashed,this),this.node.on(i.GAME_EVENTS.AIRACER_OVERTAKEN,this.onRacerOvertaken,this),this.node.on(i.GAME_EVENTS.PLAYER_REVIVED,this.onReviveActivated,this),this.node.on(i.GAME_EVENTS.GAME_OVER,this.onGameOver,this),this.playerMovement.turbosPicked=1,this.playerMovement.turnonturboindicator(),this.playerMovement.turbosPicked=2,this.playerMovement.turnonturboindicator(),n.default.isAudioMuted()&&cc.find("/Canvas/MuteButton").getComponent(cc.Toggle).check()},onRacerOvertaken:function(t){this.showToastMessage("#"+t.racerStanding+" is Out!")},onRacerThrashed:function(t){this.showToastMessage("Takedown!!")},onMuteButtonClicked:function(t){var e=t.isChecked;n.default.setAudioMuted(e),n.default.save(),e?this.setAudioVolume(0):this.setAudioVolume(1)},onDeviceEvent:function(t){console.log("GameState:",this._gameState),this._gameState==c.PAUSED||this._gameState==c.STARTED?"pause"===t&&!1===this.pauseui.active?this.togglePause():"resume"!=t||!0!==this.pauseui.active&&this._gameState!==c.PAUSED||this.togglePause():this._gameState!=c.WAITING_REVIVE&&this._gameState!=c.OVER||console.log("Director::resume")},onReviveActivated:function(){console.log("Revive activated"),cc.audioEngine.resumeMusic(),this.gaRevivesUsed+=1,this.reviveScreen.active=!1,this.playerMovement.topSpeed=n.default.getUserTopSpeed(),this._gameState=c.STARTED,this._timeLeft=a.GAMEPLAY.TIMEBOUNS_ON_REVIVE,this.timerLabel.node.active=!0;for(var t=0;t<this.turbos.length;t++)this.turboPool.put(this.turbos[t]);this._nextTurboSpawn=this._totalChunks+a.GAMEPLAY.CHUNK_COUNT_AFTER_TURBO,this.playerMovement.turbosPicked=3,this._nextTurboSpawn=this._totalChunks+a.GAMEPLAY.CHUNK_COUNT_AFTER_TURBO,cc.audioEngine.playEffect(this.turboEffectSound,!1),this.node.emit(i.GAME_EVENTS.TURBO_ACTIVATED,null),this.pauseui.active=!0;var e=new Date,o=e.getFullYear()+"-"+(parseInt(e.getMonth())+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();h.trackEvent("gameAdClaimed",{position:"death",timeStamp:o,autoPlayed:this.didAutoPlay}),this.adLoaded=!1,this.revivesAvailable>0&&PlatformLayer.preFetchVideoAd()},earlyExit:function(){this.exitType="exit",this.onGameOver()},onGameOver:function(){console.log("onGameOver Called"),this._gameState=c.OVER,this.playerMovement.topSpeed=0,this.playerMovement.speed=0,this.timerLabel.node.active=!1,cc.audioEngine.stopAll(),cc.director.resume(),this.pauseScreen.active=!1,this.reviveScreen.active=!1,this.playerMovement._score>17500&&(0!=this.playerMovement.gaTurboPickups&&0!=this.playerMovement.gaCoinPickups&&0!=this.playerMovement.gaNearMisses||(this.playerMovement._score=0,this.playerMovement.updateSpeedDisplay())),this.gameoverscoretext.string="Score: "+this.playerMovement._score,this.playerMovement._score>window.highScore?this.gameoverhighscoretext.string="New Highscore !":this.gameoverhighscoretext.string="HighScore: "+window.highScore,this.gameOverScreen.active=!0,n.default.addCoins(this.gaCoinPickups),n.default.save(),h.trackEvent("NearMisses",{eventCategory:"UserActivity",eventAction:"NearMisses",eventValue:this.playerMovement.gaNearMisses}),h.trackEvent("TurboPickups",{eventCategory:"UserActivity",eventAction:"TurboPickups",eventValue:this.playerMovement.gaTurboPickups}),h.trackEvent("CoinPickups",{eventCategory:"UserActivity",eventAction:"CoinPickups",eventValue:this.playerMovement.gaCoinPickups}),h.trackEvent("PureDistance",{eventCategory:"UserActivity",eventAction:"PureDistance",eventValue:Math.ceil(this._totalDistance-this.gaPostReviveDistanceCovered)}),h.trackEvent("BonusDistance",{eventCategory:"UserActivity",eventAction:"BonusDistance",eventValue:Math.ceil(this.gaPostReviveDistanceCovered)}),h.trackEvent("Revivesused",{eventCategory:"UserActivity",eventAction:"Revivesused",eventValue:this.gaRevivesUsed}),h.trackEvent("Collisions",{eventCategory:"UserActivity",eventAction:"Collisions",eventValue:this.playerMovement.gaCollisions}),this.playerMovement._score>window.highScore&&(window.highScore=this.playerMovement._score),this.gaRevivesUsed>0&&(this.wasAdClaimed=1);var t=Date.now()-u,e=new Date,o=e.getFullYear()+"-"+(parseInt(e.getMonth())+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();h.trackEvent("gameExit",{currentScore:this.playerMovement._score,highScore:window.highScore,playtime:(t/1e3).toFixed(0),currentTime:o,adClaimed:this.wasAdClaimed,type:this.exitType}),h.notifyGameEnd({score:this.playerMovement._score,highScore:window.highScore})},onQuitClicked:function(){cc.log("User clicked on quit button"),h.quitGame("userQuit"),cc.director.loadScene("garage")},adAvailabilityCheck:function(t){0===t.status?this.adLoaded=!0:(this.adLoaded=!1,h.trackEvent("AdUnavialable",{eventCategory:"VideoFetch",eventAction:"AdUnavailable"}))},adRewards:function(t){console.log("onAdRewards:",JSON.stringify(t)),0===t.status?this.node.emit(a.GAME_EVENTS.PLAYER_REVIVED):1===t.status?(h.trackEvent("AdSkipped",{eventCategory:"VideoPlayBack",eventAction:"AdSkipped"}),this.node.emit(a.GAME_EVENTS.GAME_OVER)):2===t.status?(h.trackEvent("AdLoadFailed",{eventCategory:"VideoPlayBack",eventAction:"AdLoadFailed"}),this.node.emit(a.GAME_EVENTS.GAME_OVER)):3===t.status&&(h.trackEvent("AdShowFailed",{eventCategory:"VideoPlayBack",eventAction:"AdShowFailed"}),this.node.emit(a.GAME_EVENTS.GAME_OVER))},startGame:function(){this._gameState=c.STARTED,this._timeLeft=this._timerConfig[this._numCheckPoints],this.timerLabel.string=""+Math.floor(this._timeLeft),this.timerLabel.node.active=!0},addCars2Segment:function(){var t=[!1,!1,!1,!1,!1,!1,!1,!1,!1];if(this.aiCarPool.size()>0){var e=cc.director.getScene(),o=this._numCheckPoints;o>this._spawnProbability.length&&(o=this._spawnProbability.length-1);for(var i=this._spawnProbability[o][1],n=Math.floor(Math.random()*t.length);i>0;){for(;t[n];)n=Math.floor(Math.random()*t.length);var s=this.aiCarPool.get();s.stopAllActions();var c=Math.floor(Math.random()*a.GAMEPLAY.LANES.length),r=a.GAMEPLAY.LANES[c];if(s.setPosition(cc.v3(r,0,-800+this._spawnZOffset[n])),s.parent=e,s.eulerAngles=cc.v3(0,0,0),t[n]=c+1,i-=1,0==this.aiCarPool.size())break;if(this.shouldspawnturbo){for(;t[n];)n=Math.floor(Math.random()*t.length);var l=this.turboPool.get();l&&(c=Math.floor(Math.random()*a.GAMEPLAY.LANES.length),l.setPosition(cc.v3(a.GAMEPLAY.LANES[c],0,-800+this._spawnZOffset[n])),l.parent=cc.director.getScene(),l.active=!0,this._nextTurboSpawn=this._totalChunks+a.GAMEPLAY.CHUNK_COUNT_FIRST_TIME_TURBO),t[n]=c+1,this.shouldspawnturbo=!1}}}return t},addCoins2Segment:function(t){for(var e=cc.director.getScene(),o=Math.floor(Math.random()*a.GAMEPLAY.LANES.length),i=(Math.floor(Math.random()*this._spawnZOffset.length),0);i<a.GAMEPLAY.COINS_PER_SET;i++){var n=this.coinPool.get();null!=n&&(n.setPosition(cc.v3(a.GAMEPLAY.LANES[o],6,t-45*i)),n.parent=e)}},showToastMessage:function(t){this.toastNode.play(),this.toastMessage.string=t},onCheckpointReached:function(t){cc.audioEngine.playEffect(this.checkpointSound,!1),this.showToastMessage("Checkpoint "+t),this._timeLeft+=this._timerConfig[Math.min(this._timerConfig.length-1,t)],this.timerLabel.string=""+Math.ceil(this._timeLeft),this.playerMovement.add2Score(a.GAMEPLAY.SCORE_COMPONENTS.CHECKPOINT_REACHED),this.playerMovement.topSpeed=n.default.getUserTopSpeed(),this.redpulse.active=!1,this.redpulseanimation.stop()},update:function(t){if(this._gameState==c.STARTED||this._gameState==c.ANIMATING){var e=cc.v3();this.speed=this.playerMovement.speed;var o=t*this.speed;if(this._totalDistance+=o,this.trafficManager+=o-a.GAMEPLAY.TRAFFIC_DEFAULT_SPEED*t,this.gaRevivesUsed>0&&(this.gaPostReviveDistanceCovered+=o),this._timeLeft-=t,this._timeLeft<=0){if(this.speed<=0){this._gameState=c.WAITING_REVIVE,this.pauseui.active=!1,this.showToastMessage("Time Out!"),this.timerLabel.node.active=!1,cc.audioEngine.playEffect(this.timeoutEffectSound,!1),this.redpulse.active=!1,this.redpulseanimation.stop(),n.default.addCoins(this._coinsCollected),n.default.save();var h=new cc.sequence(cc.delayTime(1.5),cc.callFunc(this.timeOutToastFinished,this));return void this.node.runAction(h)}0!=this.playerMovement.topSpeed&&0==this.playerMovement._turboEnabled?(this.playerMovement.topSpeed=0,this.playerMovement.updateSpeedDisplay(),this.gaRaceTime+=t):this.gaRaceTime+=t,this._timeLeft=0}else this.gaRaceTime+=t;this.timerLabel.string=""+Math.ceil(this._timeLeft),Math.ceil(this._timeLeft)<6?this.timerLabel.node.color=cc.color(255,0,0):this.timerLabel.node.color=cc.color(255,255,255),Math.ceil(this._timeLeft)<4&&0==this.redpulse.active&&0==this.boostpulse.active&&this._gameState!=c.OVER&&(this.redpulse.active=!0,this.redpulseanimation.play());for(var u=0;u<this.segments.length;u++){if(e.set(this.segments[u].position),e.z+=o,e.z>this.zLimit){if(e.z-=this.zMax,this._totalChunks+=1,this._totalChunks>=this._nextTurboSpawn){var d=a.GAMEPLAY.CHUNK_COUNT_FIRST_TIME_TURBO;3===this.playerMovement.turbosPicked?(d=a.GAMEPLAY.CHUNK_COUNT_AFTER_TURBO,this._nextTurboSpawn=this._totalChunks+d):this.shouldspawnturbo=!0}this._totalChunks%a.GAMEPLAY.CHUNKS_PER_1000M==0&&(cc.log("ScenemMovement: Checkpoint Segment Reached %d",this._totalChunks),this.checkpoint.active=!0,this._notifyCheckpoint=!0,this.checkpoint.setPosition(0,0,e.z-a.GAMEPLAY.DISTANCE_PER_CHUNK)),this._envType==r&&this._totalChunks%a.RENDERING.CHUNKS_PER_TUNNEL==0&&(this._envType=l,this._envChunkCount=0),this._envChunkCount+=1,this._envType==l&&this._envChunkCount>10&&(this._envType=r),this.segments[u].children[this._envType].active=!0,this.segments[u].children[(this._envType+1)%2].active=!1}this.segments[u].setPosition(e.x,e.y,e.z)}if(this.trafficManager>800){this.trafficManager=0;this.addCars2Segment();this.addCoins2Segment(-800)}if(this.checkpoint.active&&(e.set(this.checkpoint.position),e.z+=o,this.checkpoint.setPosition(e.x,e.y,e.z),e.z>a.RENDERING.ZMIN&&(this.checkpoint.active=!1),this._notifyCheckpoint)){var f=s.createAABB(this.checkpoint.getChildByName("bbox"));s.isOverlapping(f,this.playerMovement.bbox)&&(cc.log("SceneMovement: Checkpoint Reached!!"),this._numCheckPoints+=1,this._notifyCheckpoint=!1,this.node.emit(a.GAME_EVENTS.CHECKPOINT_REACHED,this._numCheckPoints))}for(u=0;u<this.coins.length;u++)this.coins[u].active&&(this.coins[u].position.z>a.RENDERING.ZMIN?this.coinPool.put(this.coins[u]):s.isPointInAABB(this.coins[u].position,this.playerMovement.bbox)?(this.coinPool.put(this.coins[u]),this._coinsCollected+=1,cc.audioEngine.playEffect(this.coinPickupSound),this.node.emit(i.GAME_EVENTS.COIN_PICKED,null)):s.isPointInAABB(this.coins[u].position,this.aiRacerMovement.bbox)&&this.aiRacerMovement.stateMachine.onEvent(i.GAME_EVENTS.AIRACER_COIN_COLLIDED,[this.coins[u],this.coinPool]));for(u=0;u<this.turbos.length;u++)!1!==this.turbos[u].active&&(this.turbos[u].position.z>a.RENDERING.ZMIN?this.turboPool.put(this.turbos[u]):s.isPointInAABB(this.turbos[u].position,this.playerMovement.bbox)?(this.turboPool.put(this.turbos[u]),this.playerMovement.turbosPicked+=1,this.node.emit(i.GAME_EVENTS.TURBO_PICKED,1),cc.audioEngine.playEffect(this.turboPickupSound,!1),cc.log("SceneMovement: turbosCollected"),3===this.playerMovement.turbosPicked&&(cc.log("SceneMovement: TurboActivated"),this._nextTurboSpawn=this._totalChunks+a.GAMEPLAY.CHUNK_COUNT_AFTER_TURBO,this.shouldspawnturbo=!1,cc.audioEngine.playEffect(this.turboEffectSound,!1),this.node.emit(i.GAME_EVENTS.TURBO_ACTIVATED,null))):s.isPointInAABB(this.turbos[u].position,this.aiRacerMovement.bbox)&&this.aiRacerMovement.stateMachine.onEvent(i.GAME_EVENTS.AIRACER_TURBO_COLLIDED,[this.turbos[u],this.turboPool]));for(u=0;u<this.aiCars.length;u++)if(0!=this.aiCars[u].active){var p=this.aiCars[u].position;Math.abs(p.z-this.aiRacerMovement.node.position.z)<this.aiRacerMovement.bbox.halfExtents.z&&this.aiRacerMovement.checkCollision(this.aiCars[u]),p.z<-200||(p.z>a.RENDERING.ZMIN?(this.aiCars[u].stopAllActions(),this.node.eulerAngles=cc.v3(0,0,0),this.aiCars[u].active,this.aiCarPool.put(this.aiCars[u])):this.playerMovement.checkCollision(this.aiCars[u]))}this.playerMovement.checkRacerCollision(this.aiRacer),this.scoreDisplay.string=this.playerMovement._score}}}),cc._RF.pop()},{"./Constants":"Constants","./Inventory":"Inventory",CollisionUtils:"CollisionUtils",Constants:"Constants"}],TaskMaster:[function(t,e,o){"use strict";cc._RF.push(e,"afea0d5HrlG4ayF2mQN2Hqf","TaskMaster"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function t(){this.isEnabled=!1}return t.prototype.load=function(){this.gametasks=[{name:"Disco Dancer",task:"CAR_DISPLACED",count:20,reward:50,unlocked:!1,type:"PER_RUN"},{name:"Gold Rush",task:"COIN_PICKED",count:100,reward:50,unlocked:!1,type:"PER_RUN"},{name:"Maidas Touch",task:"COIN_PICKED",count:100,reward:200,unlocked:!1,type:"PER_EVER"}];try{window.localStorage&&window.localStorage[t.TASK_DATA]&&(this.gametasks=JSON.parse(window.localStorage.getItem(t.TASK_DATA)))}catch(t){cc.log(t)}},t.prototype.save=function(){if(this.gametasks)try{window.localStorage.setItem(t.TASK_DATA,JSON.stringify(this.gametasks))}catch(t){cc.log(t)}else cc.log("Could not find user data to save.")},t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.TASK_DATA="TASKS_DATA",t}();o.default=i,cc._RF.pop()},{}],Task:[function(t,e,o){"use strict";cc._RF.push(e,"88a24dETIlAx4Hc6Y2FFPAW","Task"),Object.defineProperty(o,"__esModule",{value:!0});var i,n=t("../Constants");(function(t){t[t.PER_RUN=0]="PER_RUN",t[t.PER_EVER=1]="PER_EVER",t[t.PER_TIMED=2]="PER_TIMED"})(i||(i={})),o.TaskType=i;var a=function(){function t(t,e,o,n,a){void 0===n&&(n=10),void 0===a&&(a=i.PER_RUN),this._id=t,this._event=e,this._threshold=o,this._done=!1,this._type=a,this._reward=n}return t.prototype.onEventTriggered=function(t,e){if(this._type==i.PER_RUN&&t==n.default.GAME_EVENTS.GAME_OVER&&(this._value=0),this._event==t)try{this._value+=e.count}catch(t){this._value+=1}this._value>=this._threshold&&(this.done=!0)},Object.defineProperty(t.prototype,"currentValues",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"done",{get:function(){return this._done},set:function(t){this._done=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return""},enumerable:!0,configurable:!0}),t}();o.Task=a,cc._RF.pop()},{"../Constants":"Constants"}],TrafficHit:[function(t,e,o){"use strict";cc._RF.push(e,"35a7fZzJr9Dpb0rONyWfyZe","TrafficHit");var i=t("MyMoveTo"),n=t("../Constants"),a=n.TRAFFIC_STATES;cc.Class({extends:cc.Component,properties:{moveDirection:0,sparkPrefab:cc.Prefab},onLoad:function(){this.enabled=!1},start:function(){},createHitAnimation:function(){var t=this.node.position,e=cc.callFunc(this.hitAnimDone,this),o=3*(n.GAMEPLAY.LANES[1]-n.GAMEPLAY.LANES[0])*this.moveDirection,a=0;var s=null;if(Math.abs(t.x)>n.GAMEPLAY.LANES[n.GAMEPLAY.LANES.length-2]){a=25;var c=cc.rotate3DTo(.3,-30,-30*this.moveDirection,0);s=cc.sequence([c,e])}else{c=cc.rotate3DTo(.15,0,-30*this.moveDirection,0);var r=cc.rotate3DTo(.15,0,0,0);s=cc.sequence([c,r,e])}var l=new i(.25,t.x+o,t.y+a,t.z- -50);return cc.spawn([l,s])},onEnable:function(){cc.log("TrafficHit: Enabled"),cc.log("TrafficHit: %d",this.moveDirection);var t=this.node.getComponent(n.AI_COMPONENT);if(0===this.moveDirection){var e=this.node.position,o=.15*Math.max(t.speed,100),s=cc.rotate3DTo(.15,10,0,0),c=cc.rotate3DTo(.15,-10,0,0),r=cc.rotate3DTo(.15,0,0,0),l=cc.callFunc(this.hitAnimDone,this),h=cc.sequence([s,c,r,l]),u=new i(.15,e.x,e.y,e.z-o),d=cc.spawn([u,h]);this.node.runAction(d),(f=cc.instantiate(t.sparkPrefab)).setPosition(cc.v3(0,0,-5)),f.parent=this.node}else if(2==this.moveDirection)this.aicar.speed=0,this.aicar.setState(a.MOVING);else{var f;d=this.createHitAnimation();this.node.runAction(d),(f=cc.instantiate(t.sparkPrefab)).setPosition(cc.v3(-1*this.moveDirection*5,5,0)),f.parent=this.node}},hitAnimDone:function(){this.aicar=this.node.getComponent(n.AI_COMPONENT),this.aicar.speed*=.5,this.node.eulerAngles=cc.v3(0,0,0),this.aicar.setState(a.MOVING)},update:function(t){},onDisable:function(){cc.log("TrafficHit: Disabled")}}),cc._RF.pop()},{"../Constants":"Constants",MyMoveTo:"MyMoveTo"}],TrafficMoving:[function(t,e,o){"use strict";cc._RF.push(e,"053bbIOdMpDEasoy6jpVF6p","TrafficMoving");var i=t("Constants");cc.Class({extends:cc.Component,properties:{},start:function(){var t=cc.find("GameController");this.sm=t.getComponent(i.ENV_COMPONENT);var e=this.node.getComponent(i.AI_COMPONENT);this.speed=i.GAMEPLAY.PICKUPS_SPEED,this.isAICar=!1,e&&(this.speed=e.speed,this.isAICar=!0)},onEnable:function(){var t=this.node.getComponent(i.AI_COMPONENT);this.isAICar?this.speed=t.speed:this.speed=i.GAMEPLAY.PICKUPS_SPEED},update:function(t){if(this.sm._gameState!=i.GAME_STATES.OVER){this.isAICar||(this.sm._timeLeft<=0?this.speed=i.GAMEPLAY.PICKUPS_SPEED_ON_TIMEUP:this.speed=i.GAMEPLAY.PICKUPS_SPEED);var e=t*(this.sm.speed-this.speed),o=this.node.position;o.z+=e,o.y=o.y,this.node.position=o}},onDisable:function(){}}),cc._RF.pop()},{Constants:"Constants"}],TrafficThrashed:[function(t,e,o){"use strict";cc._RF.push(e,"4212cc1Pq5J+L3cKUXS7+Y4","TrafficThrashed");var i=t("Constants"),n=t("MyMoveTo");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.enabled=!1},start:function(){},update:function(t){},onEnable:function(){for(var t=2,e=0;e<i.GAMEPLAY.LANES.length;e++)if(this.node.position.x===i.GAMEPLAY.LANES[e]){t=e;break}cc.log("Lane: %d",t);var o=null,a=null;t<2?(o=new n(1,-100,[100,150,130,200][Math.floor(4*Math.random())],400),a=cc.rotate3DTo(.5,[100,150,130,200][Math.floor(4*Math.random())],[100,150,130,200][Math.floor(4*Math.random())],[100,150,130,200][Math.floor(4*Math.random())])):2==t?(o=new n(1,0,[100,150,130,200][Math.floor(4*Math.random())],400),a=cc.rotate3DTo(.5,[100,150,130,200][Math.floor(4*Math.random())],[100,150,130,200][Math.floor(4*Math.random())],[100,150,130,200][Math.floor(4*Math.random())])):(o=new n(1,100,[100,150,130,200][Math.floor(4*Math.random())],400),a=cc.rotate3DTo(.5,[100,150,130,200][Math.floor(4*Math.random())],[100,150,130,200][Math.floor(4*Math.random())],[100,150,130,200][Math.floor(4*Math.random())]));var s=cc.callFunc(this.onAnimFinish,this),c=cc.spawn([o,a]),r=cc.sequence([c,s]);this.node.runAction(r)},onAnimFinish:function(){cc.log("Thrashing: Finished"),this.enabled=!1},onDisable:function(){cc.log("Thrashing: Disabled"),this.node.eulerAngles=cc.v3(0,0,0)}}),cc._RF.pop()},{Constants:"Constants",MyMoveTo:"MyMoveTo"}],"use_v2.1-2.2.1_cc.Toggle_event":[function(t,e,o){"use strict";cc._RF.push(e,"329deiSIrpPv7Xf0LJHLwOJ","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["use_v2.1-2.2.1_cc.Toggle_event","AICar","CameraAnimations","Coin","CollisionUtils","Constants","EnvMap","GameObject","InputHandler","Inventory","LayoutHandler","MenuHandler","MyMoveTo","PlatformLayer","PlayerMovement","SceneMovement","Task","TaskMaster","CarCustomization","CarPaintState","DefaultState","HoodDecalState","MenuConstants","MenuState","MenuStateMachine","RoofDecalState","RacerCar","RacerDefault","RacerThrashed","RacerTurbo","RacerWaiting","TrafficHit","TrafficMoving","TrafficThrashed"]);